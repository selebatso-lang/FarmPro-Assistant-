<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>FarmPro Assistant - Ultimate Farming Solution</title>

<!-- PWA Meta Tags -->
<meta name="application-name" content="Farm Manager">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Farm Manager">
<meta name="description" content="Complete farm management solution">
<meta name="format-detection" content="telephone=no">
<meta name="mobile-web-app-capable" content="yes">
<meta name="msapplication-TileColor" content="#388e3c">
<meta name="msapplication-tap-highlight" content="no">
<meta name="theme-color" content="#388e3c">

<!-- Apple Touch Icons -->
<link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiMzODhFM0MiLz4KPHBhdGggZD0iTTk2IDM2QzY4IDM2IDQ0IDYwIDQ0IDg4QzQ0IDExNiA2OCAxNDAgOTYgMTQwQzEyNCAxNDAgMTQ4IDExNiAxNDggODhDMTQ4IDYwIDEyNCAzNiA5NiAzNlpNMTI0IDExNkMxMjQgMTMyIDEwOCAxNDQgOTYgMTQ0Qzg0IDE0NCA2OCAxMzIgNjggMTE2VjE1NkM2OCAxNzIgODQgMTg0IDk2IDE4NEMxMDggMTg0IDEyNCAxNzIgMTI0IDE1NlYxMTZaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K">

<!-- Favicon -->
<link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzM4OEUzQyIvPgo8cGF0aCBkPSJNMTYgNkMxMiA2IDggMTAgOCAxNEM4IDE4IDEyIDIyIDE2IDIyQzIwIDIyIDI0IDE4IDI0IDE0QzI0IDEwIDIwIDYgMTYgNlpNMjAgMTlDMjAgMjEgMTggMjMgMTYgMjNDMTQgMjMgMTIgMjEgMTIgMTlWMjVDMTIgMjcgMTQgMjkgMTYgMjkjMTggMjkgMjAgMjcgMjAgMjVWMTlaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K">

<style>
:root {
  --primary: #388e3c;
  --secondary: #2e7d32;
  --danger: #d32f2f;
  --warning: #f57c00;
  --info: #1976d2;
  --light: #f5f5f5;
  --dark: #333;
  --muted: #757575;
  --growth: #4caf50;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: #f8f9fa;
  color: var(--dark);
  line-height: 1.6;
}

.app-container {
  max-width: 1200px;
  margin: 0 auto;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* Header Styles */
header {
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
  padding: 1.5rem;
  text-align: center;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

header div:first-child {
  font-size: 1.8rem;
  font-weight: bold;
  margin-bottom: 0.3rem;
}

header div:last-child {
  font-size: 0.9rem;
  font-weight: normal;
  opacity: 0.9;
}

/* Farm Profile Header */
.farm-profile-header {
  background: white;
  padding: 1.5rem;
  border-bottom: 1px solid #e0e0e0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.farm-profile-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 1rem;
}

.farm-info {
  flex: 1;
  min-width: 300px;
}

.farm-name {
  font-size: 1.5rem;
  font-weight: bold;
  color: var(--primary);
  margin-bottom: 0.5rem;
}

.farm-details {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  font-size: 0.9rem;
  color: var(--muted);
}

.farm-actions {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Dashboard Styles */
.dashboard-section {
  background: white;
  padding: 1.5rem;
  margin: 1rem 0;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.dashboard-title {
  color: var(--primary);
  margin-bottom: 1rem;
  font-size: 1.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-bottom: 1.5rem;
}

.dashboard-card {
  background: #f8f9fa;
  padding: 1.5rem;
  border-radius: 8px;
  border-left: 4px solid var(--primary);
  transition: transform 0.3s, box-shadow 0.3s;
}

.dashboard-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.dashboard-card h3 {
  color: var(--primary);
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
}

.dashboard-card .value {
  font-size: 1.8rem;
  font-weight: bold;
  color: var(--dark);
  margin-bottom: 0.5rem;
}

.dashboard-card .change {
  font-size: 0.9rem;
  color: var(--muted);
}

.positive {
  color: var(--primary);
}

.negative {
  color: var(--danger);
}

/* Trial Countdown */
.trial-countdown {
  background: #ffebee;
  color: var(--danger);
  padding: 0.8rem 1.5rem;
  border-radius: 8px;
  margin: 1rem 0;
  text-align: center;
  font-weight: bold;
  font-size: 1.1rem;
  border-left: 4px solid var(--danger);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.8; }
  100% { opacity: 1; }
}

/* Quick Actions */
.quick-actions {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

/* Tab Grid */
.tab-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
  margin: 1rem 0;
}

.tab-card {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  border: 2px solid transparent;
}

.tab-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  border-color: var(--primary);
}

.tab-card.active {
  background: var(--primary);
  color: white;
  transform: translateY(-5px);
  box-shadow: 0 5px 15px rgba(56, 142, 60, 0.4);
}

.tab-icon {
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
}

.tab-title {
  font-weight: bold;
  font-size: 1.1rem;
}

.tab-description {
  font-size: 0.9rem;
  opacity: 0.8;
  margin-top: 0.5rem;
}

/* Content Area */
.content-area {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  margin: 1rem 0;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  min-height: 400px;
  animation: fadeIn 0.5s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Form Styles */
.form-group {
  margin-bottom: 1.5rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: bold;
  color: var(--dark);
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 0.8rem;
  border: 2px solid #ddd;
  border-radius: 6px;
  font-size: 1rem;
  transition: border-color 0.3s;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  border-color: var(--primary);
  outline: none;
  box-shadow: 0 0 0 3px rgba(56, 142, 60, 0.1);
}

/* Button Styles */
button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.8rem 1.5rem;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.3s;
}

button:hover {
  background: var(--secondary);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.btn-outline {
  background: transparent;
  border: 2px solid var(--primary);
  color: var(--primary);
}

.btn-outline:hover {
  background: var(--primary);
  color: white;
}

.btn-harvest {
  background: linear-gradient(135deg, var(--primary), var(--growth));
}

.btn-harvest:hover {
  background: linear-gradient(135deg, var(--secondary), #3d8b40);
}

.small {
  padding: 0.5rem 1rem;
  font-size: 0.9rem;
}

/* Status Indicators */
.status-active {
  color: var(--primary);
  font-weight: bold;
}

.status-warning {
  color: var(--warning);
  font-weight: bold;
}

.status-danger {
  color: var(--danger);
  font-weight: bold;
}

/* Progress Bar */
.progress-bar {
  background: #f0f0f0;
  border-radius: 10px;
  height: 20px;
  margin: 0.5rem 0;
  overflow: hidden;
}

.progress-fill-bar {
  background: var(--primary);
  height: 100%;
  border-radius: 10px;
  transition: width 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 0.8rem;
  font-weight: bold;
}

/* Table Styles */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1rem 0;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

th, td {
  padding: 1rem;
  text-align: left;
  border-bottom: 1px solid #e0e0e0;
}

th {
  background: var(--primary);
  color: white;
  font-weight: 600;
}

tr:hover {
  background: #f8f9fa;
}

/* Splash Screen */
.app-splash {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 9999;
  transition: opacity 0.5s ease;
}

.splash-logo {
  font-size: 4rem;
  margin-bottom: 1rem;
  animation: bounce 2s infinite;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-20px); }
}

.splash-text {
  color: white;
  font-size: 2rem;
  font-weight: bold;
}

/* Modal Styles */
.activation-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  z-index: 1000;
  justify-content: center;
  align-items: center;
}

.activation-content {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  max-width: 500px;
  width: 90%;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

/* Notification Styles */
.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  padding: 1rem 1.5rem;
  border-radius: 6px;
  color: white;
  font-weight: 500;
  z-index: 1001;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  animation: slideIn 0.3s ease;
}

@keyframes slideIn {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

.notification.success {
  background: var(--primary);
}

.notification.error {
  background: var(--danger);
}

.notification.warning {
  background: var(--warning);
}

.notification.info {
  background: var(--info);
}

/* Loading Overlay */
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255,255,255,0.9);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 999;
}

.loading-spinner {
  width: 50px;
  height: 50px;
  border: 5px solid #f3f3f3;
  border-top: 5px solid var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 1rem;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Setup Screen */
.setup-screen {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  margin: 2rem auto;
  max-width: 600px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
  text-align: center;
}

.setup-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
  color: var(--primary);
}

.setup-title {
  font-size: 1.8rem;
  color: var(--primary);
  margin-bottom: 1rem;
}

.setup-description {
  color: var(--muted);
  margin-bottom: 2rem;
}

/* Responsive Design */
@media (max-width: 768px) {
  .farm-profile-content {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .farm-actions {
    width: 100%;
    justify-content: center;
  }
  
  .dashboard-grid {
    grid-template-columns: 1fr;
  }
  
  .tab-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .quick-actions {
    justify-content: center;
  }
}

@media (max-width: 480px) {
  .tab-grid {
    grid-template-columns: 1fr;
  }
}

/* Trial Status */
.trial-status {
  background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;
  border-left: 4px solid var(--warning);
  text-align: center;
}

.trial-status.expired {
  background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
  border-left-color: var(--danger);
}

/* Footer */
footer {
  background: var(--dark);
  color: white;
  padding: 1.5rem;
  text-align: center;
  margin-top: 2rem;
}

.contact-info {
  font-weight: bold;
  margin-bottom: 0.5rem;
}

.support-text {
  font-size: 0.9rem;
  opacity: 0.8;
}

/* Read-only Mode */
.readonly-mode .farm-profile-header {
  opacity: 0.7;
  background: #f5f5f5;
}

.readonly-mode .dashboard-section,
.readonly-mode .tab-grid,
.readonly-mode .content-area {
  opacity: 0.7;
  pointer-events: none;
}

.readonly-mode button:not(#activateBtn) {
  display: none;
}

.readonly-mode input,
.readonly-mode select,
.readonly-mode textarea {
  background: #e9ecef;
  pointer-events: none;
}

.readonly-message {
  background: #ffebee;
  color: var(--danger);
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;
  text-align: center;
  font-weight: bold;
  border-left: 4px solid var(--danger);
}

/* Inventory Items */
.inventory-item, .pos-item, .cart-item, .task-card, .client-card, .planted-crop-card {
  background: white;
  padding: 1rem;
  border-radius: 8px;
  margin-bottom: 1rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  border-left: 4px solid var(--primary);
}

.quantity-controls {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.quantity-btn {
  width: 30px;
  height: 30px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Report Styles */
.report-period-selector {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.period-btn {
  background: white;
  border: 1px solid #ddd;
  color: var(--dark);
  padding: 0.5rem 1rem;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;
}

.period-btn.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

#customDateRange {
  display: none;
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;
}

/* Grid Layouts */
.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 2rem;
}

@media (max-width: 768px) {
  .grid-2 {
    grid-template-columns: 1fr;
  }
}

/* Detail Sections */
.detail-section {
  background: #f8f9fa;
  padding: 1rem;
  border-radius: 8px;
  margin: 1rem 0;
}

.care-stage {
  background: white;
  padding: 1rem;
  border-radius: 6px;
  margin: 0.5rem 0;
  border-left: 3px solid var(--primary);
}

/* Stock Status */
.out-of-stock {
  border-left-color: var(--danger);
}

.low-stock {
  border-left-color: var(--warning);
}

.crop-status {
  display: flex;
  justify-content: space-between;
  margin: 0.5rem 0;
}
/* Activation Modal Scrollable */
.activation-content {
    max-height: 90vh;
    overflow-y: auto;
}

/* Smooth scrolling for modal */
.activation-content::-webkit-scrollbar {
    width: 8px;
}

.activation-content::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.activation-content::-webkit-scrollbar-thumb {
    background: var(--primary);
    border-radius: 4px;
}

.activation-content::-webkit-scrollbar-thumb:hover {
    background: var(--secondary);
}
</style>
</head>

<body>
<!-- Splash Screen -->
<div class="app-splash" id="splashScreen">
  <div class="splash-logo">üå±</div>
  <div class="splash-text">Farm Manager</div>
</div>

<!-- Notification Container -->
<div id="notificationContainer"></div>

<div class="app-container">
  <header>
    <div>FarmPro Assistant</div>
    <div>Cultivate Your Success</div>
  </header>

  <!-- Main Content Area -->
  <main id="mainContent" style="padding: 0 1.5rem;">
    <!-- Setup Screen (Shown when no farm profile exists) -->
    <div id="setupScreen" class="setup-screen" style="display: none;">
      <div class="setup-icon">üë®‚Äçüåæ</div>
      <h1 class="setup-title">Welcome to FarmPro Assistant</h1>
      <p class="setup-description">To get started, please set up your farm profile. This will begin your 7-day free trial.</p>
      
      <div style="text-align: left; max-width: 400px; margin: 0 auto;">
        <div class="form-group">
          <label for="setupFarmName">Farm Name:*</label>
          <input type="text" id="setupFarmName" placeholder="Green Valley Acres" required>
        </div>
        
        <div class="form-group">
          <label for="setupFarmerName">Farmer Name:*</label>
          <input type="text" id="setupFarmerName" placeholder="John Chibwe" required>
        </div>
        
        <div class="form-group">
          <label for="setupHectares">Farm Size (hectares):*</label>
          <input type="number" id="setupHectares" placeholder="125" min="1" required>
        </div>
        
        <div class="form-group">
          <label for="setupContact">Contact Number:*</label>
          <input type="text" id="setupContact" placeholder="260-976-123456" required>
        </div>
        
        <div class="form-group">
          <label for="setupFarmType">Farm Type:</label>
          <select id="setupFarmType">
            <option value="">Select farm type</option>
            <option value="crop">Crop Farming</option>
            <option value="livestock">Livestock</option>
            <option value="mixed">Mixed Farming</option>
            <option value="poultry">Poultry</option>
            <option value="dairy">Dairy</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="setupAddress">Farm Address:</label>
          <textarea id="setupAddress" placeholder="Farm location address" rows="3"></textarea>
        </div>
        
        <button onclick="saveFarmProfile()" class="btn-harvest" style="width: 100%; padding: 1rem; font-size: 1.1rem;">
          ‚úÖ Save Farm Profile & Start 7-Day Trial
        </button>
        
        <p style="margin-top: 1rem; font-size: 0.9rem; color: var(--muted);">
          By saving your profile, you agree to start your 7-day free trial. After trial ends, activate for full access.
        </p>
      </div>
    </div>

    <!-- App Interface (Shown when farm profile exists) -->
    <div id="appInterface" style="display: none;">
      <!-- Farm Profile Header (Always Visible) -->
      <div class="farm-profile-header" id="farmProfileHeader">
        <div class="farm-profile-content">
          <div class="farm-info">
            <div class="farm-name" id="farmNameHeader">FarmPro Assistant</div>
            <div class="farm-details">
              <span id="farmSizeDisplay">Setup your farm profile</span>
              <span id="farmTypeDisplay"></span>
              <span id="farmStatusDisplay" class="status-warning">Not Configured</span>
            </div>
          </div>
          <div class="farm-actions">
            <button onclick="editFarmProfile()" class="small">Edit Profile</button>
            <button onclick="showActivationModal()" id="activateBtn" class="small btn-harvest" style="display: none;">Activate</button>
            <button onclick="shareOnWhatsApp()" class="small btn-outline">Share</button>
          </div>
        </div>
        
        <!-- Trial Status (if applicable) -->
        <div id="trialStatus" class="trial-status" style="display: none;">
          <h4>‚è≥ Trial Period Active</h4>
          <p>Your 7-day free trial is active. Activate now for uninterrupted access.</p>
        </div>
      </div>

      <!-- Trial Countdown Timer -->
      <div id="trialCountdown" class="trial-countdown" style="display: none;">
        ‚è∞ Trial Expires in: <span id="countdownTimer">7 days 00:00:00</span>
      </div>

      <!-- Read-only Message (Shown when trial expired) -->
      <div id="readOnlyMessage" class="readonly-message" style="display: none;">
        ‚ö†Ô∏è Trial period expired. Please activate FarmPro for full access.
      </div>

      <!-- Dashboard (Always Visible) -->
      <section class="dashboard-section">
        <div class="dashboard-title">
          <span>üìä Farm Dashboard</span>
        </div>
        
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <h3>Planted Crops</h3>
            <div class="value" id="cropCount">0</div>
            <div class="change positive">+0 this week</div>
          </div>
          
          <div class="dashboard-card">
            <h3>Inventory Value</h3>
            <div class="value" id="inventoryValue">0 Pula</div>
            <div class="change positive">+0% from last month</div>
          </div>
          
          <div class="dashboard-card">
            <h3>Pending Tasks</h3>
            <div class="value" id="taskCount">0</div>
            <div class="change negative">-0% completed</div>
          </div>
          
          <div class="dashboard-card">
            <h3>Financial Balance</h3>
            <div class="value" id="financeBalance">0 Pula</div>
            <div class="change positive">+0% growth</div>
          </div>
        </div>
        
        <div class="quick-actions">
          <button onclick="openTab('cropGuideTab')" class="small">üå± Crop Guide</button>
          <button onclick="openTab('myCropsTab')" class="small">üåæ My Crops</button>
          <button onclick="openTab('inventoryTab')" class="small">üì¶ Inventory</button>
          <button onclick="openTab('posTab')" class="small">üõí POS</button>
          <button onclick="openTab('financeTab')" class="small">üí∞ Finance</button>
          <button onclick="openTab('clientsTab')" class="small">üë• Clients</button>
          <button onclick="openTab('tasksTab')" class="small">üìã Tasks</button>
          <button onclick="openTab('reportsTab')" class="small">üìä Reports</button>
        </div>
      </section>

      <!-- Tab Grid -->
      <!-- Add this with the other tab cards -->
<div class="tab-card" id="premiumTab" onclick="openTab('premiumTab')">
    <div class="tab-icon">‚≠ê</div>
    <div class="tab-title">Premium</div>
    <div class="tab-description">Advanced features & tools</div>
</div>

      <div class="tab-grid">
        <div class="tab-card" id="cropGuideTab" onclick="openTab('cropGuideTab')">
          <div class="tab-icon">üå±</div>
          <div class="tab-title">Crop Guide</div>
          <div class="tab-description">Growing information & guides</div>
        </div>
        
        <div class="tab-card" id="myCropsTab" onclick="openTab('myCropsTab')">
          <div class="tab-icon">üåæ</div>
          <div class="tab-title">My Crops</div>
          <div class="tab-description">Manage planted crops</div>
        </div>
        
        <div class="tab-card" id="inventoryTab" onclick="openTab('inventoryTab')">
          <div class="tab-icon">üì¶</div>
          <div class="tab-title">Inventory</div>
          <div class="tab-description">Stock & product management</div>
        </div>
        
        <div class="tab-card" id="posTab" onclick="openTab('posTab')">
          <div class="tab-icon">üõí</div>
          <div class="tab-title">Point of Sale</div>
          <div class="tab-description">Sales & transactions</div>
        </div>
        
        <div class="tab-card" id="financeTab" onclick="openTab('financeTab')">
          <div class="tab-icon">üí∞</div>
          <div class="tab-title">Finance</div>
          <div class="tab-description">Income, expenses & reports</div>
        </div>
        
        <div class="tab-card" id="clientsTab" onclick="openTab('clientsTab')">
          <div class="tab-icon">üë•</div>
          <div class="tab-title">Clients</div>
          <div class="tab-description">Customer management</div>
        </div>
        
        <div class="tab-card" id="tasksTab" onclick="openTab('tasksTab')">
          <div class="tab-icon">üìã</div>
          <div class="tab-title">Tasks</div>
          <div class="tab-description">Schedule & track work</div>
        </div>
        
        <div class="tab-card" id="reportsTab" onclick="openTab('reportsTab')">
          <div class="tab-icon">üìä</div>
          <div class="tab-title">Reports</div>
          <div class="tab-description">Analytics & insights</div>
        </div>
      </div>

      <!-- Content Area (Changes based on selected tab) -->
      <div class="content-area" id="contentArea">
        <div style="text-align: center; padding: 3rem; color: var(--muted);">
          <div style="font-size: 4rem; margin-bottom: 1rem;">üë®‚Äçüåæ</div>
          <h2>Welcome to FarmPro Assistant</h2>
          <p>Select a tab above to get started with farm management</p>
        </div>
      </div>
    </div>
  </main>

<!-- Activation Modal -->
<div id="activationModal" class="activation-modal">
    <div class="activation-content" style="max-height: 90vh; overflow-y: auto;">
        <h2>üîê Unlock Full FarmPro Features!</h2>
        
        <!-- Marketing Message -->
        <div style="background: linear-gradient(135deg, #388e3c, #2e7d32); color: white; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem; text-align: center;">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üöÄ</div>
            <h3 style="margin-bottom: 0.5rem; color: white;">Upgrade to Premium!</h3>
            <p style="margin-bottom: 0; opacity: 0.9;">
                ‚ú® <strong>Unlock all features</strong> - Advanced analytics, unlimited crops, and premium support<br>
                üìà <strong>Grow your profits</strong> - Make data-driven decisions to maximize your farm's potential<br>
                üå± <strong>Never lose data</strong> - Permanent access to all your farm records and history<br>
                üí™ <strong>Join successful farmers</strong> who are already transforming their operations!
            </p>
        </div>
        
        <div id="farmInfo" style="margin-bottom: 15px;">
            <!-- Farm info will be displayed here -->
        </div>
        
        <p><strong>Enter the activation code provided by support:</strong></p>
        
        <input type="text" id="activationCode" placeholder="Enter code (e.g., HH89818925HH)" 
               style="margin: 1rem 0; font-size: 1.2rem; text-align: center; letter-spacing: 2px; width: 100%; padding: 0.8rem; border: 2px solid #ddd; border-radius: 6px;">
        
        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
            <button onclick="activateApp()" style="flex: 1;" class="btn-harvest">üöÄ Activate Premium</button>
            <button onclick="closeActivationModal()" class="btn-outline" style="flex: 1;">Maybe Later</button>
        </div>
        
        <div style="margin-top: 1.5rem; padding: 15px; background: #fff8e1; border-radius: 8px; border-left: 4px solid #f57c00;">
            <h4 style="color: #f57c00; margin-bottom: 0.5rem;">üìû How to Get Your Code:</h4>
            <ol style="margin: 0; padding-left: 1.2rem;">
                <li><strong>Send your farm details above</strong> to our support team</li>
                <li><strong>Receive your unique activation code</strong> via WhatsApp/SMS</li>
                <li><strong>Enter the code here</strong> to unlock premium features instantly!</li>
            </ol>
            <div style="margin-top: 0.8rem; padding: 0.8rem; background: #e3f2fd; border-radius: 5px;">
                <strong>üí¨ Contact Support:</strong><br>
                <span style="font-weight: bold; color: #1976d2;">+267 7678 1005 / +267 7293 3326</span><br>
                <em>Available 7 days a week to help you grow!</em>
            </div>
        </div>
        
        <!-- Premium Features Preview -->
        <div style="margin-top: 1.5rem; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
            <h4 style="color: var(--primary); margin-bottom: 0.8rem;">üéØ What You'll Unlock:</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.8rem; font-size: 0.9rem;">
                <div>‚úÖ Unlimited crop tracking</div>
                <div>‚úÖ Advanced analytics</div>
                <div>‚úÖ Financial reports</div>
                <div>‚úÖ Inventory management</div>
                <div>‚úÖ Client database</div>
                <div>‚úÖ Task scheduling</div>
                <div>‚úÖ Priority support</div>
                <div>‚úÖ Data backup</div>
            </div>
        </div>
    </div>
</div>
      <div class="muted" style="margin-top: 1rem;">
        Contact support with your farm details to get activation code
      </div>
    </div>
  </div>

  <footer>
    <div class="contact-info">Contact Support: +267 7678 1005 / +267 7293 3326</div>
    <div class="support-text">FarmPro Assistant - Cultivate Your Success</div>
  </footer>
</div>

<script>
// =============================================
// FARM PRO ASSISTANT - COMPLETE IMPLEMENTATION
// =============================================

document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ FarmPro Assistant Initializing...');
    
    // Hide splash screen after 2 seconds
    setTimeout(hideSplashScreen, 2000);
});

// =============================================
// APP STATE AND DATA MANAGEMENT
// =============================================

let farmData;
let farmProfile;
let currentTab = null;
let trialInterval = null;
let posCart = [];
let currentReportPeriod = 'weekly';
let currentReportType = '';

// Initialize data
function initializeAppState() {
    try {
        // Load farm profile
        const savedProfile = localStorage.getItem('fa_farmProfile');
        farmProfile = savedProfile ? JSON.parse(savedProfile) : null;
        
        // Load farm data
        const savedData = localStorage.getItem('fa_data');
        farmData = savedData ? JSON.parse(savedData) : {
            inventory: [],
            finances: { 
                income: [], 
                expenses: [], 
                balance: 0 
            },
            sales: [],
            plantedCrops: [],
            tasks: [],
            clients: []
        };
        
        // Initialize POS cart
        const savedCart = localStorage.getItem('fa_posCart');
        posCart = savedCart ? JSON.parse(savedCart) : [];
        
        console.log('‚úÖ App state initialized');
    } catch (error) {
        console.error('‚ùå Error initializing app state:', error);
        // Initialize with default data
        farmProfile = null;
        
        farmData = {
            inventory: [],
            finances: { income: [], expenses: [], balance: 0 },
            sales: [],
            plantedCrops: [],
            tasks: [],
            clients: []
        };
        
        posCart = [];
        safeSaveData();
    }
}

// =============================================
// UTILITY FUNCTIONS
// =============================================

function getElement(id) {
    const element = document.getElementById(id);
    if (!element) console.warn(`Element '${id}' not found`);
    return element;
}

function safeSaveData() {
    try {
        localStorage.setItem('fa_data', JSON.stringify(farmData));
        localStorage.setItem('fa_posCart', JSON.stringify(posCart));
        if (farmProfile) {
            localStorage.setItem('fa_farmProfile', JSON.stringify(farmProfile));
        }
        updateDashboard();
        updateFarmProfileHeader();
        return true;
    } catch (error) {
        console.error('‚ùå Storage error:', error);
        showNotification('Storage full. Please clear some data or backup your information.', 'error');
        return false;
    }
}

function showNotification(message, type = 'info') {
    const container = getElement('notificationContainer');
    if (!container) {
        alert(message);
        return;
    }
    
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    
    container.appendChild(notification);
    
    // Auto remove after 5 seconds
    setTimeout(() => {
        if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
        }
    }, 5000);
}

// =============================================
// SPLASH SCREEN MANAGEMENT
// =============================================

function hideSplashScreen() {
    const splash = getElement('splashScreen');
    if (splash) {
        console.log('üîÑ Hiding splash screen...');
        splash.style.transition = 'opacity 0.5s ease';
        splash.style.opacity = '0';
        
        setTimeout(() => {
            splash.style.display = 'none';
            console.log('‚úÖ Splash screen hidden');
            initializeMainApp();
        }, 500);
    } else {
        console.log('‚ö†Ô∏è No splash screen found, initializing app directly');
        initializeMainApp();
    }
}

// =============================================
// MAIN APP INITIALIZATION
// =============================================

function initializeMainApp() {
    console.log('üöÄ Initializing FarmPro Assistant...');
    
    initializeAppState();
    
    // Check if farm profile exists
    if (!farmProfile || !farmProfile.farmName) {
        // Show setup screen
        showSetupScreen();
    } else {
        // Show app interface
        showAppInterface();
        updateFarmProfileHeader();
        updateDashboard();
        checkTrialStatus();
    }
}

function showSetupScreen() {
    const setupScreen = getElement('setupScreen');
    const appInterface = getElement('appInterface');
    
    if (setupScreen) setupScreen.style.display = 'block';
    if (appInterface) appInterface.style.display = 'none';
}

function showAppInterface() {
    const setupScreen = getElement('setupScreen');
    const appInterface = getElement('appInterface');
    
    if (setupScreen) setupScreen.style.display = 'none';
    if (appInterface) appInterface.style.display = 'block';
}

// =============================================
// FARM PROFILE MANAGEMENT
// =============================================

function saveFarmProfile() {
    const profile = {
        farmName: getElement('setupFarmName')?.value.trim(),
        farmerName: getElement('setupFarmerName')?.value.trim(),
        hectares: parseInt(getElement('setupHectares')?.value),
        contact: getElement('setupContact')?.value.trim(),
        type: getElement('setupFarmType')?.value,
        address: getElement('setupAddress')?.value.trim(),
        trialStart: new Date().toISOString(),
        activated: false
    };
    
    // Validate required fields
    if (!profile.farmName || !profile.farmerName || !profile.hectares || !profile.contact) {
        showNotification('Please fill all required fields.', 'error');
        return;
    }
    
    if (profile.hectares <= 0) {
        showNotification('Please enter a valid farm size.', 'error');
        return;
    }
    
    // Save profile
    farmProfile = profile;
    
    if (safeSaveData()) {
        showNotification('‚úÖ Farm profile saved! 7-day trial started.', 'success');
        showAppInterface();
        updateFarmProfileHeader();
        startTrialCountdown();
        
        // Show activation button
        const activateBtn = getElement('activateBtn');
        if (activateBtn) activateBtn.style.display = 'inline-block';
        
        // Show trial status
        const trialStatus = getElement('trialStatus');
        if (trialStatus) trialStatus.style.display = 'block';
    } else {
        showNotification('Failed to save farm profile.', 'error');
    }
}

function updateFarmProfileHeader() {
    const farmNameHeader = getElement('farmNameHeader');
    const farmSizeDisplay = getElement('farmSizeDisplay');
    const farmTypeDisplay = getElement('farmTypeDisplay');
    const farmStatusDisplay = getElement('farmStatusDisplay');
    
    if (farmProfile && farmProfile.farmName) {
        farmNameHeader.textContent = farmProfile.farmName;
        farmSizeDisplay.textContent = `${farmProfile.hectares} hectares`;
        
        if (farmProfile.type) {
            farmTypeDisplay.textContent = farmProfile.type;
        }
        
        if (farmProfile.activated) {
            farmStatusDisplay.textContent = '‚úÖ Activated';
            farmStatusDisplay.className = 'status-active';
        } else if (farmProfile.trialStart) {
            const trialStart = new Date(farmProfile.trialStart);
            const now = new Date();
            const daysElapsed = (now - trialStart) / (1000 * 60 * 60 * 24);
            
            if (daysElapsed < 7) {
                farmStatusDisplay.textContent = '‚è≥ Trial Active';
                farmStatusDisplay.className = 'status-warning';
            } else {
                farmStatusDisplay.textContent = '‚ö†Ô∏è Trial Expired';
                farmStatusDisplay.className = 'status-danger';
            }
        } else {
            farmStatusDisplay.textContent = 'üîß Setup Required';
            farmStatusDisplay.className = 'status-warning';
        }
    } else {
        farmNameHeader.textContent = 'FarmPro Assistant';
        farmSizeDisplay.textContent = 'Setup your farm profile';
        farmStatusDisplay.textContent = 'Not Configured';
        farmStatusDisplay.className = 'status-warning';
    }
}

function editFarmProfile() {
    // For demo purposes, we'll just show a notification
    showNotification('Edit profile functionality would open here', 'info');
}

// =============================================
// TRIAL MANAGEMENT
// =============================================

function checkTrialStatus() {
    if (!farmProfile || !farmProfile.trialStart) return;
    
    const trialStart = new Date(farmProfile.trialStart);
    const now = new Date();
    const daysElapsed = (now - trialStart) / (1000 * 60 * 60 * 24);
    
    if (farmProfile.activated) {
        // App is activated - hide all trial elements
        const trialCountdown = getElement('trialCountdown');
        const trialStatus = getElement('trialStatus');
        const readOnlyMessage = getElement('readOnlyMessage');
        
        if (trialCountdown) trialCountdown.style.display = 'none';
        if (trialStatus) trialStatus.style.display = 'none';
        if (readOnlyMessage) readOnlyMessage.style.display = 'none';
        
        // Clear any existing interval
        if (trialInterval) {
            clearInterval(trialInterval);
            trialInterval = null;
        }
        
        // Remove read-only mode
        document.body.classList.remove('readonly-mode');
    } else if (daysElapsed < 7) {
        // Trial is active
        const trialCountdown = getElement('trialCountdown');
        const trialStatus = getElement('trialStatus');
        const readOnlyMessage = getElement('readOnlyMessage');
        const activateBtn = getElement('activateBtn');
        
        if (trialCountdown) trialCountdown.style.display = 'block';
        if (trialStatus) trialStatus.style.display = 'block';
        if (readOnlyMessage) readOnlyMessage.style.display = 'none';
        if (activateBtn) activateBtn.style.display = 'inline-block';
        
        // Remove read-only mode
        document.body.classList.remove('readonly-mode');
        
        // Start countdown
        startTrialCountdown();
    } else {
        // Trial expired
        const trialCountdown = getElement('trialCountdown');
        const trialStatus = getElement('trialStatus');
        const readOnlyMessage = getElement('readOnlyMessage');
        const activateBtn = getElement('activateBtn');
        
        if (trialCountdown) trialCountdown.style.display = 'none';
        if (trialStatus) {
            trialStatus.style.display = 'block';
            trialStatus.classList.add('expired');
            trialStatus.innerHTML = `
                <h4>‚ö†Ô∏è Trial Expired</h4>
                <p>Please activate for full access</p>
            `;
        }
        if (readOnlyMessage) readOnlyMessage.style.display = 'block';
        if (activateBtn) activateBtn.style.display = 'inline-block';
        
        // Enable read-only mode
        enableReadOnlyMode();
        
        // Clear any existing interval
        if (trialInterval) {
            clearInterval(trialInterval);
            trialInterval = null;
        }
    }
}

function startTrialCountdown() {
    if (!farmProfile || !farmProfile.trialStart || farmProfile.activated) return;
    
    // Clear any existing interval
    if (trialInterval) {
        clearInterval(trialInterval);
    }
    
    const trialStart = new Date(farmProfile.trialStart);
    const trialEnd = new Date(trialStart.getTime() + 7 * 24 * 60 * 60 * 1000);
    
    function updateCountdown() {
        const now = new Date();
        const timeLeft = trialEnd - now;
        
        if (timeLeft <= 0) {
            // Trial expired
            const countdownTimer = getElement('countdownTimer');
            if (countdownTimer) countdownTimer.textContent = 'Trial Expired';
            
            // Enable read-only mode
            enableReadOnlyMode();
            
            // Show expired messages
            const trialCountdown = getElement('trialCountdown');
            const trialStatus = getElement('trialStatus');
            const readOnlyMessage = getElement('readOnlyMessage');
            
            if (trialCountdown) trialCountdown.style.display = 'none';
            if (trialStatus) {
                trialStatus.style.display = 'block';
                trialStatus.classList.add('expired');
                trialStatus.innerHTML = `
                    <h4>‚ö†Ô∏è Trial Expired</h4>
                    <p>Please activate for full access</p>
                `;
            }
            if (readOnlyMessage) readOnlyMessage.style.display = 'block';
            
            // Clear interval
            clearInterval(trialInterval);
            trialInterval = null;
            
            return;
        }
        
        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
        
        const countdownTimer = getElement('countdownTimer');
        if (countdownTimer) {
            countdownTimer.textContent = `${days}d ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
    }
    
    // Update immediately and then every second
    updateCountdown();
    trialInterval = setInterval(updateCountdown, 1000);
}

function enableReadOnlyMode() {
    document.body.classList.add('readonly-mode');
    showNotification('Trial period expired. Please activate for full access.', 'warning');
}

// =============================================
// DASHBOARD FUNCTIONS
// =============================================

function updateDashboard() {
    try {
        // Update crop count
        const cropCount = getElement('cropCount');
        if (cropCount) {
            cropCount.textContent = farmData.plantedCrops.length;
        }
        
        // Update inventory value
        const inventoryValue = getElement('inventoryValue');
        if (inventoryValue) {
            const totalValue = farmData.inventory.reduce((sum, item) => 
                sum + (item.quantity * item.price), 0);
            inventoryValue.textContent = `${totalValue.toFixed(2)} Pula`;
        }
        
        // Update task count
        const taskCount = getElement('taskCount');
        if (taskCount) {
            const pendingTasks = farmData.tasks.filter(task => !task.completed).length;
            taskCount.textContent = pendingTasks;
        }
        
        // Update finance balance
        const financeBalance = getElement('financeBalance');
        if (financeBalance) {
            financeBalance.textContent = `${farmData.finances.balance.toFixed(2)} Pula`;
        }
        
    } catch (error) {
        console.error('Error updating dashboard:', error);
    }
}

// =============================================
// TAB MANAGEMENT
// =============================================

function openTab(tabId) {
    // Check if app is in read-only mode and not activated
    if (document.body.classList.contains('readonly-mode') && (!farmProfile || !farmProfile.activated)) {
        showNotification('Trial expired. Please activate for full access.', 'warning');
        return;
    }
    
    // Remove active class from all tabs
    document.querySelectorAll('.tab-card').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Add active class to selected tab
    const selectedTab = getElement(tabId);
    if (selectedTab) {
        selectedTab.classList.add('active');
    }
    
    // Update current tab
    currentTab = tabId;
    
    // Load tab content
    loadTabContent(tabId);
}

function loadTabContent(tabId) {
    const contentArea = getElement('contentArea');
    if (!contentArea) return;
    
    let content = '';
    
    switch(tabId) {
        case 'cropGuideTab':
            content = loadCropGuideContent();
            break;
            
        case 'myCropsTab':
            content = loadMyCropsContent();
            break;
            
        case 'inventoryTab':
            content = loadInventoryContent();
            break;
            
        case 'posTab':
            content = loadPOSContent();
            break;
            
        case 'financeTab':
            content = loadFinanceContent();
            break;
            
        case 'clientsTab':
            content = loadClientsContent();
            break;
            
        case 'tasksTab':
            content = loadTasksContent();
            break;
            
        case 'reportsTab':
            content = loadReportsContent();
            break;
            
        case 'premiumTab':
            if (farmProfile && farmProfile.activated) {
                content = loadPremiumContent();
            } else {
                content = `
                    <div style="text-align: center; padding: 3rem; color: var(--muted);">
                        <div style="font-size: 4rem; margin-bottom: 1rem;">üîí</div>
                        <h2>Premium Features Locked</h2>
                        <p>Activate your account to unlock advanced analytics, market intelligence, and premium crops.</p>
                        <button onclick="showActivationModal()" class="btn-harvest" style="margin-top: 1rem;">üöÄ Activate Now</button>
                    </div>
                `;
            }
            break;
            
        default:
            content = `
                <div style="text-align: center; padding: 3rem; color: var(--muted);">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">üë®‚Äçüåæ</div>
                    <h2>Welcome to FarmPro Assistant</h2>
                    <p>Select a tab above to get started with farm management</p>
                </div>
            `;
    }
    
    contentArea.innerHTML = content;
    loadTabData(tabId);
}


function loadTabData(tabId) {
    switch(tabId) {
        case 'cropGuideTab':
            loadCropGuide();
            break;
        case 'myCropsTab':
            loadMyCrops();
            break;
        case 'inventoryTab':
            loadInventory();
            break;
        case 'posTab':
            loadPOSProducts();
            break;
        case 'financeTab':
            loadFinanceData();
            break;
        case 'clientsTab':
            loadClients();
            break;
        case 'tasksTab':
            loadTasks();
            break;
        case 'reportsTab':
            setupCustomDateRange();
            break;
    }
}

// =============================================
// CROP DATABASE & GUIDE FUNCTIONS
// =============================================

const cropDatabase = {
    maize: {
        name: "Maize",
        type: "Cereal",
        growthTime: "90-120 days",
        yield: "3-8 tons/ha",
        season: "Nov-Jan (Summer)",
        price: "5-8 Pula/kg",
        pests: ["Fall Armyworm", "Stem Borer", "Aphids"],
        diseases: ["Maize Streak Virus", "Grey Leaf Spot", "Rust"],
        chemicals: ["Emamectin Benzoate", "Chlorantraniliprole", "Lambda-cyhalothrin"],
        description: "Maize is a staple food crop in Southern Africa, suitable for various soil types.",
        careStages: [
            {
                stage: "Germination",
                duration: "7-10 days",
                tasks: ["Prepare well-drained soil", "Plant seeds 3-5cm deep", "Ensure adequate moisture"]
            },
            {
                stage: "Vegetative Growth",
                duration: "30-45 days",
                tasks: ["Apply nitrogen fertilizer", "Control weeds", "Monitor for pests"]
            },
            {
                stage: "Flowering",
                duration: "10-14 days",
                tasks: ["Ensure adequate water", "Monitor pollination", "Control diseases"]
            },
            {
                stage: "Grain Filling",
                duration: "30-40 days",
                tasks: ["Reduce water gradually", "Monitor for pests", "Prepare for harvest"]
            }
        ]
    },
    sorghum: {
        name: "Sorghum",
        type: "Cereal",
        growthTime: "90-120 days",
        yield: "2-5 tons/ha",
        season: "Nov-Feb (Summer)",
        price: "6-10 Pula/kg",
        pests: ["Sorghum Midge", "Stem Borer", "Aphids"],
        diseases: ["Anthracnose", "Grain Mold", "Downy Mildew"],
        chemicals: ["Acetamiprid", "Carbaryl", "Mancozeb"],
        description: "A drought-tolerant cereal grain essential for food security in arid regions.",
        careStages: [
            {
                stage: "Establishment",
                duration: "10-15 days",
                tasks: ["Plant in warm soil", "Shallow planting (2-3cm)", "Control weeds early"]
            },
            {
                stage: "Tillering",
                duration: "30-40 days",
                tasks: ["Apply top-dressing fertilizer", "Thin if necessary", "Monitor for midge"]
            },
            {
                stage: "Grain Development",
                duration: "40-50 days",
                tasks: ["Bird scaring", "Disease control", "Stop irrigation for ripening"]
            }
        ]
    },
    millet: {
        name: "Pearl Millet",
        type: "Cereal",
        growthTime: "75-100 days",
        yield: "1-3 tons/ha",
        season: "Nov-Feb (Summer)",
        price: "7-12 Pula/kg",
        pests: ["Millet Head Miner", "Birds", "Stem Borers"],
        diseases: ["Downy Mildew", "Rust", "Smut"],
        chemicals: ["Spinosad", "Lambda-cyhalothrin", "Metalaxyl"],
        description: "One of the most drought-resistant cereals, thrives in sandy, low-fertility soils.",
        careStages: [
            {
                stage: "Germination",
                duration: "3-5 days",
                tasks: ["Plant in moist soil", "Shallow sowing", "Light rolling after planting"]
            },
            {
                stage: "Vegetative",
                duration: "30-50 days",
                tasks: ["Low nitrogen application", "Weed control", "Monitor for borers"]
            },
            {
                stage: "Heading & Maturity",
                duration: "30-40 days",
                tasks: ["Intensive bird control", "Harvest when grain is hard", "Dry thoroughly"]
            }
        ]
    },
    wheat: {
        name: "Wheat",
        type: "Cereal",
        growthTime: "120-150 days",
        yield: "3-6 tons/ha",
        season: "May-Sep (Winter)",
        price: "8-12 Pula/kg",
        pests: ["Russian Wheat Aphid", "Hessian Fly", "Armyworm"],
        diseases: ["Stem Rust", "Leaf Rust", "Fusarium Head Blight"],
        chemicals: ["Imidacloprid", "Triazole fungicides", "Carbendazim"],
        description: "Winter cereal crop requiring cool temperatures for optimal growth.",
        careStages: [
            {
                stage: "Germination & Establishment",
                duration: "10-20 days",
                tasks: ["Plant in cool soil", "Adequate soil moisture", "Pre-emergence herbicide"]
            },
            {
                stage: "Tillering",
                duration: "40-60 days",
                tasks: ["Nitrogen top-dressing", "Monitor for aphids", "Weed control"]
            },
            {
                stage: "Grain Filling",
                duration: "40-50 days",
                tasks: ["Fungicide application at heading", "Monitor for lodging", "Harvest at 13-15% moisture"]
            }
        ]
    },
    rice: {
        name: "Rice",
        type: "Cereal",
        growthTime: "90-150 days",
        yield: "4-8 tons/ha",
        season: "Dec-Apr (Summer, irrigated)",
        price: "10-15 Pula/kg",
        pests: ["Rice Stem Borer", "Rice Bug", "Armyworm"],
        diseases: ["Rice Blast", "Brown Spot", "Sheath Blight"],
        chemicals: ["Chlorantraniliprole", "Tricyclazole", "Validamycin"],
        description: "Staple grain requiring controlled water management, grown in wetlands or irrigated fields.",
        careStages: [
            {
                stage: "Nursery & Transplanting",
                duration: "25-35 days",
                tasks: ["Prepare paddy fields", "Transplant seedlings", "Maintain shallow water level"]
            },
            {
                stage: "Vegetative Growth",
                duration: "40-60 days",
                tasks: ["Gradual water depth increase", "Nitrogen application", "Weed control"]
            },
            {
                stage: "Reproductive Stage",
                duration: "30-40 days",
                tasks: ["Drain fields before harvest", "Disease management", "Harvest when 80% grains golden"]
            }
        ]
    },
    cowpeas: {
        name: "Cowpeas",
        type: "Legume",
        growthTime: "65-95 days",
        yield: "1-2 tons/ha (dry grain)",
        season: "Dec-Mar (Summer)",
        price: "12-20 Pula/kg",
        pests: ["Aphids", "Flower Thrips", "Pod Borers"],
        diseases: ["Cowpea Aphid-Borne Mosaic Virus", "Bacterial Blight", "Fusarium Wilt"],
        chemicals: ["Imidacloprid", "Emamectin Benzoate", "Copper-based fungicides"],
        description: "A hardy, drought-tolerant legume that fixes nitrogen in the soil.",
        careStages: [
            {
                stage: "Establishment",
                duration: "7-10 days",
                tasks: ["Inoculate seeds with rhizobia", "Plant in warm soil", "Ensure good seed-soil contact"]
            },
            {
                stage: "Flowering",
                duration: "15-20 days",
                tasks: ["Critical pest control for thrips", "Ensure adequate moisture", "Avoid water stress"]
            },
            {
                stage: "Podding",
                duration: "25-35 days",
                tasks: ["Monitor for pod borers", "Harvest pods multiple times", "Dry grains to 10% moisture"]
            }
        ]
    },
    groundnuts: {
        name: "Groundnuts (Peanuts)",
        type: "Legume",
        growthTime: "100-130 days",
        yield: "1-3 tons/ha (in-shell)",
        season: "Nov-Mar (Summer)",
        price: "15-25 Pula/kg",
        pests: ["Aphids", "Termites", "Red Spider Mites"],
        diseases: ["Groundnut Rosette Virus", "Early Leaf Spot", "Aflatoxin contamination"],
        chemicals: ["Thiamethoxam", "Chlorothalonil", "Proper drying to prevent aflatoxin"],
        description: "An important oilseed and protein legume, requires careful harvesting and drying.",
        careStages: [
            {
                stage: "Germination & Emergence",
                duration: "7-14 days",
                tasks: ["Plant certified, disease-free seed", "Well-drained, loose soil", "Avoid deep planting"]
            },
            {
                stage: "Pegging",
                duration: "40-50 days",
                tasks: ["Hill soil around plants", "Maintain even moisture", "Calcium application"]
            },
            {
                stage: "Pod Maturation",
                duration: "30-40 days",
                tasks: ["Stop irrigation before harvest", "Test for maturity", "Lift and dry quickly"]
            }
        ]
    },
    soybeans: {
        name: "Soybeans",
        type: "Legume",
        growthTime: "90-120 days",
        yield: "1.5-3.5 tons/ha",
        season: "Dec-Mar (Summer)",
        price: "10-18 Pula/kg",
        pests: ["Soybean Looper", "Stink Bugs", "Red Spider Mite"],
        diseases: ["Soybean Rust", "Bacterial Pustule", "Charcoal Rot"],
        chemicals: ["Indoxacarb", "Acetamiprid", "Azoxystrobin"],
        description: "High-protein oilseed critical for animal feed and soil health.",
        careStages: [
            {
                stage: "Germination & Emergence",
                duration: "5-10 days",
                tasks: ["Inoculate seeds with specific rhizobia", "Plant in well-drained soil", "Ensure good moisture"]
            },
            {
                stage: "Reproductive Stages",
                duration: "50-60 days",
                tasks: ["Critical irrigation at flowering/pod set", "Foliar fertilizer application", "Intensive pest scouting"]
            },
            {
                stage: "Maturation & Harvest",
                duration: "20-30 days",
                tasks: ["Desiccate if necessary", "Harvest at 15% moisture", "Avoid shattering losses"]
            }
        ]
    },
    bambara_groundnut: {
        name: "Bambara Groundnut",
        type: "Legume",
        growthTime: "90-120 days",
        yield: "0.8-1.5 tons/ha",
        season: "Nov-Mar (Summer)",
        price: "20-35 Pula/kg",
        pests: ["Aphids", "Leaf Beetles", "Storage Weevils"],
        diseases: ["Leaf Spot", "Root Rot", "Virus Diseases"],
        chemicals: ["Neem-based insecticides", "Copper fungicides", "Proper storage practices"],
        description: "Indigenous African legume extremely drought-tolerant and nutritious.",
        careStages: [
            {
                stage: "Planting & Emergence",
                duration: "7-14 days",
                tasks: ["Plant in well-drained sandy soil", "Space plants 20-30cm apart", "Light irrigation for establishment"]
            },
            {
                stage: "Vegetative & Flowering",
                duration: "50-70 days",
                tasks: ["Minimal water requirements", "Weed control", "Natural pest management"]
            },
            {
                stage: "Pod Development & Harvest",
                duration: "30-40 days",
                tasks: ["Stop irrigation for pod maturity", "Hand harvest when leaves yellow", "Dry pods thoroughly before storage"]
            }
        ]
    },
    pigeon_pea: {
        name: "Pigeon Pea",
        type: "Legume",
        growthTime: "120-180 days",
        yield: "1-2 tons/ha (dry grain)",
        season: "Oct-Apr (Summer)",
        price: "15-25 Pula/kg",
        pests: ["Pod Borers", "Pod Fly", "Aphids"],
        diseases: ["Wilt", "Sterility Mosaic", "Phytophthora Blight"],
        chemicals: ["Monocrotophos", "Carbendazim", "Neem extracts"],
        description: "Deep-rooted, drought-tolerant legume excellent for soil improvement.",
        careStages: [
            {
                stage: "Establishment",
                duration: "15-25 days",
                tasks: ["Plant in rows 60-90cm apart", "Inoculate seeds", "Light irrigation"]
            },
            {
                stage: "Vegetative Growth",
                duration: "60-100 days",
                tasks: ["Minimal fertilizer needs", "Weed control until canopy closure", "Prune for branching if desired"]
            },
            {
                stage: "Flowering & Podding",
                duration: "45-60 days",
                tasks: ["Multiple harvests possible", "Monitor for pod borers", "Dry grains properly"]
            }
        ]
    },
    tomatoes: {
        name: "Tomatoes",
        type: "Vegetable",
        growthTime: "70-90 days",
        yield: "20-40 tons/ha",
        season: "Year-round (avoid frost)",
        price: "8-15 Pula/kg",
        pests: ["Tuta absoluta", "Whitefly", "Aphids"],
        diseases: ["Early Blight", "Late Blight", "Bacterial Wilt"],
        chemicals: ["Chlorantraniliprole", "Copper fungicides", "Mancozeb"],
        description: "High-value vegetable with continuous demand.",
        careStages: [
            {
                stage: "Nursery",
                duration: "3-4 weeks",
                tasks: ["Seed sowing in trays", "Temperature control (25-30¬∞C)", "Harden off seedlings before transplanting"]
            },
            {
                stage: "Field Establishment",
                duration: "2-3 weeks",
                tasks: ["Transplanting", "Staking/Trellising", "Drip irrigation installation"]
            },
            {
                stage: "Production",
                duration: "6-8 weeks",
                tasks: ["Regular harvest (2-3 times/week)", "Weekly fungicide sprays", "Balanced fertigation"]
            }
        ]
    },
    onions: {
        name: "Onions",
        type: "Vegetable",
        growthTime: "120-150 days",
        yield: "25-50 tons/ha",
        season: "Mar-Aug (Winter), Oct-Feb (Summer)",
        price: "6-12 Pula/kg",
        pests: ["Onion Thrips", "Onion Fly", "Cutworms"],
        diseases: ["Purple Blotch", "Downy Mildew", "Basal Rot"],
        chemicals: ["Spinosad", "Chlorothalonil", "Fosetyl-Al"],
        description: "A key bulb vegetable requiring a long, cool growing season for best bulbing.",
        careStages: [
            {
                stage: "Nursery/Transplanting",
                duration: "6-8 weeks",
                tasks: ["Sow in nursery beds", "Transplant when pencil-thick", "Shallow planting"]
            },
            {
                stage: "Vegetative Growth",
                duration: "60-80 days",
                tasks: ["Consistent moisture", "Nitrogen application", "Control thrips rigorously"]
            },
            {
                stage: "Bulb Maturation & Curing",
                duration: "30-40 days",
                tasks: ["Stop irrigation for ripening", "Lift bulbs carefully", "Cure in field for 1-2 weeks"]
            }
        ]
    },
    cabbage: {
        name: "Cabbage",
        type: "Vegetable",
        growthTime: "80-120 days",
        yield: "30-70 tons/ha",
        season: "Year-round in high-altitude areas",
        price: "4-8 Pula/head",
        pests: ["Diamondback Moth", "Cabbage Aphid", "Cutworms"],
        diseases: ["Black Rot", "Clubroot", "Alternaria Leaf Spot"],
        chemicals: ["Bacillus thuringiensis (Bt)", "Acetamiprid", "Metalaxyl for Clubroot"],
        description: "A leafy green vegetable that requires consistent moisture and pest management.",
        careStages: [
            {
                stage: "Nursery",
                duration: "4-5 weeks",
                tasks: ["Raised seedbeds", "Protect from heavy rain/sun", "Disease prevention"]
            },
            {
                stage: "Transplanting & Establishment",
                duration: "2-3 weeks",
                tasks: ["Transplant at 4-6 leaves", "Spacing 40-60cm", "Water immediately"]
            },
            {
                stage: "Head Formation",
                duration: "40-60 days",
                tasks: ["High nitrogen fertigation", "Regular scouting for DBM", "Maintain even soil moisture"]
            }
        ]
    },
    spinach: {
        name: "Spinach",
        type: "Leafy Vegetable",
        growthTime: "40-50 days",
        yield: "10-20 tons/ha",
        season: "Cool, dry season (Apr-Sep)",
        price: "10-20 Pula/bunch",
        pests: ["Leafminers", "Aphids", "Caterpillars"],
        diseases: ["Downy Mildew", "White Rust", "Damping-off"],
        chemicals: ["Abamectin", "Phosphonic acid compounds", "Metalaxyl"],
        description: "A fast-growing, nutrient-rich leafy green.",
        careStages: [
            {
                stage: "Establishment",
                duration: "10-15 days",
                tasks: ["Direct seeding in rows", "Thin to proper spacing", "Keep soil moist"]
            },
            {
                stage: "Rapid Growth",
                duration: "20-25 days",
                tasks: ["Frequent, light nitrogen applications", "Overhead irrigation for cooling", "Harvest outer leaves regularly"]
            }
        ]
    },
    butternut: {
        name: "Butternut Squash",
        type: "Vegetable",
        growthTime: "90-110 days",
        yield: "15-30 tons/ha",
        season: "Aug-Nov (Spring)",
        price: "5-10 Pula/kg",
        pests: ["Fruit Fly", "Aphids", "Spider Mites"],
        diseases: ["Powdery Mildew", "Downy Mildew", "Gummy Stem Blight"],
        chemicals: ["Difenoconazole", "Cypermethrin for fruit fly", "Sulfur dust"],
        description: "A popular winter squash with good storage life.",
        careStages: [
            {
                stage: "Nursery & Transplanting",
                duration: "3-4 weeks",
                tasks: ["Start in pots", "Transplant after frost danger", "Use plastic mulch"]
            },
            {
                stage: "Vine Growth & Flowering",
                duration: "40-50 days",
                tasks: ["Train vines", "Encourage pollinators", "Control powdery mildew"]
            },
            {
                stage: "Fruit Development",
                duration: "30-40 days",
                tasks: ["Reduce watering near maturity", "Check for fruit fly", "Harvest with a handle"]
            }
        ]
    },
    watermelon: {
        name: "Watermelon",
        type: "Fruit Vegetable",
        growthTime: "80-100 days",
        yield: "20-40 tons/ha",
        season: "Aug-Dec (Spring-Summer)",
        price: "8-15 Pula/kg",
        pests: ["Fruit Fly", "Aphids", "Red Spider Mite"],
        diseases: ["Fusarium Wilt", "Anthracnose", "Gummy Stem Blight"],
        chemicals: ["Cypermethrin for fruit fly", "Difenoconazole", "Copper-based fungicides"],
        description: "A popular summer fruit requiring warm temperatures and well-drained soil.",
        careStages: [
            {
                stage: "Germination & Establishment",
                duration: "10-15 days",
                tasks: ["Plant in warm soil (>20¬∞C)", "Use plastic mulch for warmth", "Space plants 1.5-2m apart"]
            },
            {
                stage: "Vine Development",
                duration: "30-40 days",
                tasks: ["Apply balanced fertilizer", "Control weeds early", "Train vines if necessary"]
            },
            {
                stage: "Flowering & Fruit Set",
                duration: "20-30 days",
                tasks: ["Ensure good pollination", "Monitor for fruit fly", "Thin fruits for better size"]
            },
            {
                stage: "Fruit Maturation",
                duration: "20-25 days",
                tasks: ["Reduce watering near maturity", "Check for ripeness (ground spot, sound)", "Harvest carefully to avoid damage"]
            }
        ]
    },
    cucumber: {
        name: "Cucumber",
        type: "Vegetable",
        growthTime: "50-70 days",
        yield: "15-30 tons/ha",
        season: "Year-round (avoid frost)",
        price: "10-20 Pula/kg",
        pests: ["Fruit Fly", "Spider Mites", "Aphids"],
        diseases: ["Powdery Mildew", "Downy Mildew", "Angular Leaf Spot"],
        chemicals: ["Cypermethrin", "Sulfur dust", "Copper fungicides"],
        description: "Fast-growing vine crop for fresh market or processing.",
        careStages: [
            {
                stage: "Germination & Establishment",
                duration: "7-14 days",
                tasks: ["Plant in warm soil", "Use trellising for straight fruits", "Adequate spacing"]
            },
            {
                stage: "Vine Growth",
                duration: "20-30 days",
                tasks: ["Regular watering", "Balanced fertilization", "Weed control"]
            },
            {
                stage: "Harvest Period",
                duration: "25-35 days",
                tasks: ["Harvest every 2-3 days", "Handle carefully to avoid bruising", "Cool immediately after harvest"]
            }
        ]
    },
    okra: {
        name: "Okra",
        type: "Vegetable",
        growthTime: "50-65 days",
        yield: "8-15 tons/ha",
        season: "Sep-Mar (Warm season)",
        price: "15-25 Pula/kg",
        pests: ["Fruit Borer", "Aphids", "Jassids"],
        diseases: ["Fusarium Wilt", "Yellow Vein Mosaic", "Powdery Mildew"],
        chemicals: ["Emamectin Benzoate", "Imidacloprid", "Wettable sulfur"],
        description: "Heat-loving vegetable with continuous harvest potential.",
        careStages: [
            {
                stage: "Germination",
                duration: "5-10 days",
                tasks: ["Soak seeds overnight", "Plant in warm soil", "Thin to proper spacing"]
            },
            {
                stage: "Vegetative Growth",
                duration: "25-35 days",
                tasks: ["Nitrogen application", "Weed control", "Staking if necessary"]
            },
            {
                stage: "Continuous Harvest",
                duration: "30-50 days",
                tasks: ["Harvest pods every 2-3 days", "Cut pods carefully", "Regular fertilization"]
            }
        ]
    },
    eggplant: {
        name: "Eggplant (Brinjal)",
        type: "Vegetable",
        growthTime: "70-85 days",
        yield: "25-35 tons/ha",
        season: "Aug-Feb (Warm season)",
        price: "12-20 Pula/kg",
        pests: ["Fruit Borer", "Aphids", "Whitefly"],
        diseases: ["Phomopsis Blight", "Bacterial Wilt", "Fusarium Wilt"],
        chemicals: ["Spinosad", "Acetamiprid", "Copper-based fungicides"],
        description: "Tropical vegetable requiring warm temperatures and consistent moisture.",
        careStages: [
            {
                stage: "Nursery & Transplanting",
                duration: "4-6 weeks",
                tasks: ["Start seeds in trays", "Transplant at 6-8 leaves", "Space 60-75cm apart"]
            },
            {
                stage: "Vegetative & Flowering",
                duration: "30-40 days",
                tasks: ["Staking for support", "Balanced fertilization", "Monitor for fruit borer"]
            },
            {
                stage: "Fruiting & Harvest",
                duration: "30-45 days",
                tasks: ["Harvest when fruits glossy", "Regular picking encourages production", "Post-harvest cooling"]
            }
        ]
    },
    cauliflower: {
        name: "Cauliflower",
        type: "Vegetable",
        growthTime: "70-120 days",
        yield: "15-25 tons/ha",
        season: "Mar-Aug (Cool season)",
        price: "15-25 Pula/head",
        pests: ["Diamondback Moth", "Aphids", "Cabbage Worm"],
        diseases: ["Black Rot", "Downy Mildew", "Clubroot"],
        chemicals: ["Bacillus thuringiensis", "Acetamiprid", "Metalaxyl"],
        description: "Cool-season crop requiring consistent temperatures for proper curd development.",
        careStages: [
            {
                stage: "Nursery",
                duration: "4-5 weeks",
                tasks: ["Temperature control (15-20¬∞C)", "Protect from heat", "Harden seedlings"]
            },
            {
                stage: "Transplanting & Growth",
                duration: "40-60 days",
                tasks: ["Transplant in cool weather", "Consistent moisture", "Balanced nutrition"]
            },
            {
                stage: "Curd Development",
                duration: "15-25 days",
                tasks: ["Blanching (tying leaves over curd)", "Harvest before flowering", "Cool immediately after harvest"]
            }
        ]
    },
    broccoli: {
        name: "Broccoli",
        type: "Vegetable",
        growthTime: "60-100 days",
        yield: "10-20 tons/ha",
        season: "Mar-Aug (Cool season)",
        price: "12-20 Pula/kg",
        pests: ["Cabbage Worm", "Aphids", "Diamondback Moth"],
        diseases: ["Black Rot", "Downy Mildew", "Clubroot"],
        chemicals: ["Bacillus thuringiensis", "Imidacloprid", "Copper fungicides"],
        description: "Nutritious cool-season vegetable with high market demand.",
        careStages: [
            {
                stage: "Nursery",
                duration: "4-5 weeks",
                tasks: ["Start in seed trays", "Temperature control", "Harden before transplanting"]
            },
            {
                stage: "Field Growth",
                duration: "40-60 days",
                tasks: ["Transplant at 4-6 leaves", "Regular irrigation", "Side-dress with nitrogen"]
            },
            {
                stage: "Head Formation & Harvest",
                duration: "15-25 days",
                tasks: ["Harvest before flower buds open", "Cut with 15cm stem", "Rapid cooling after harvest"]
            }
        ]
    },
    lettuce: {
        name: "Lettuce",
        type: "Leafy Vegetable",
        growthTime: "45-70 days",
        yield: "20-40 tons/ha",
        season: "Mar-Sep (Cool season)",
        price: "8-15 Pula/head",
        pests: ["Aphids", "Cutworms", "Slugs"],
        diseases: ["Bottom Rot", "Downy Mildew", "Tip Burn"],
        chemicals: ["Pymetrozine", "Metaldehyde for slugs", "Fosetyl-Al"],
        description: "Fast-growing leafy vegetable for fresh markets.",
        careStages: [
            {
                stage: "Germination",
                duration: "7-10 days",
                tasks: ["Light required for germination", "Cool temperatures", "Shallow planting"]
            },
            {
                stage: "Vegetative Growth",
                duration: "25-45 days",
                tasks: ["Consistent moisture", "Nitrogen fertilization", "Weed control"]
            },
            {
                stage: "Harvest",
                duration: "10-15 days",
                tasks: ["Harvest in cool morning", "Avoid bruising leaves", "Immediate cooling"]
            }
        ]
    },
    kale: {
        name: "Kale",
        type: "Leafy Vegetable",
        growthTime: "55-75 days",
        yield: "15-25 tons/ha",
        season: "Year-round (best in cool weather)",
        price: "10-18 Pula/bunch",
        pests: ["Cabbage Worm", "Aphids", "Flea Beetles"],
        diseases: ["Black Rot", "Downy Mildew", "Alternaria Leaf Spot"],
        chemicals: ["Bacillus thuringiensis", "Acetamiprid", "Chlorothalonil"],
        description: "Highly nutritious leafy green, very cold-tolerant.",
        careStages: [
            {
                stage: "Establishment",
                duration: "15-25 days",
                tasks: ["Direct seed or transplant", "Space 30-45cm apart", "Consistent moisture"]
            },
            {
                stage: "Leaf Production",
                duration: "40-50 days",
                tasks: ["Regular nitrogen application", "Harvest outer leaves", "Continuous harvest possible"]
            }
        ]
    },
    potatoes: {
        name: "Potatoes",
        type: "Tuber",
        growthTime: "100-120 days",
        yield: "20-50 tons/ha",
        season: "Feb-May (Autumn), Sep-Dec (Spring)",
        price: "8-15 Pula/kg",
        pests: ["Potato Tuber Moth", "Aphids", "Cutworms"],
        diseases: ["Late Blight", "Early Blight", "Bacterial Wilt"],
        chemicals: ["Cymoxanil + Mancozeb", "Imidacloprid", "Metalaxyl"],
        description: "A major staple food and cash crop, sensitive to soil conditions and diseases.",
        careStages: [
            {
                stage: "Seedbed Preparation & Planting",
                duration: "0-30 days",
                tasks: ["Use certified seed tubers", "Pre-sprout (chit) seeds", "Plant in ridges"]
            },
            {
                stage: "Vegetative Growth",
                duration: "30-60 days",
                tasks: ["Earth up (hill) soil around plants", "Preventative fungicide for blight", "Control aphids to prevent virus spread"]
            },
            {
                stage: "Tuber Bulking & Maturity",
                duration: "40-50 days",
                tasks: ["Maintain consistent moisture", "Stop irrigation before harvest", "Allow skins to set before digging"]
            }
        ]
    },
    sweet_potatoes: {
        name: "Sweet Potatoes",
        type: "Tuber",
        growthTime: "120-150 days",
        yield: "15-30 tons/ha",
        season: "Oct-Mar (Summer)",
        price: "7-12 Pula/kg",
        pests: ["Sweet Potato Weevil", "Leaf Beetles", "Nematodes"],
        diseases: ["Viral Complex (SPVD)", "Alternaria Leaf Spot", "Soft Rot"],
        chemicals: ["Clean planting material", "Crop rotation for nematodes", "Chlorothalonil"],
        description: "A highly nutritious, drought-tolerant root crop.",
        careStages: [
            {
                stage: "Vine Cutting & Planting",
                duration: "0-20 days",
                tasks: ["Use healthy vine tips as cuttings", "Plant on ridges or mounds", "Ensure good soil contact"]
            },
            {
                stage: "Vine Cover",
                duration: "60-80 days",
                tasks: ["Weed control until full cover", "Lift vines to prevent roots", "Monitor for weevils"]
            },
            {
                stage: "Root Development",
                duration: "40-50 days",
                tasks: ["Reduce water to encourage tubering", "Harvest carefully to avoid damage", "Cure at high temp/humidity after harvest"]
            }
        ]
    },
    carrots: {
        name: "Carrots",
        type: "Root Vegetable",
        growthTime: "70-100 days",
        yield: "25-50 tons/ha",
        season: "Cool seasons (Mar-Sep)",
        price: "10-18 Pula/kg",
        pests: ["Carrot Rust Fly", "Aphids", "Nematodes"],
        diseases: ["Alternaria Leaf Blight", "Powdery Mildew", "Bacterial Soft Rot"],
        chemicals: ["Diazinon for rust fly", "Azoxystrobin", "Neem oil extracts"],
        description: "A popular root vegetable requiring deep, loose, stone-free soil.",
        careStages: [
            {
                stage: "Seedbed & Sowing",
                duration: "10-14 days",
                tasks: ["Prepare fine, deep tilth", "Sow seeds shallowly", "Keep soil surface moist for germination"]
            },
            {
                stage: "Thinning & Early Growth",
                duration: "30-40 days",
                tasks: ["Thin to 5cm apart", "Side-dress with fertilizer", "Control weeds carefully"]
            },
            {
                stage: "Root Thickening",
                duration: "30-40 days",
                tasks: ["Consistent moisture for smooth roots", "Monitor for leaf blight", "Harvest based on market size"]
            }
        ]
    },
    green_beans: {
        name: "Green Beans",
        type: "Vegetable",
        growthTime: "50-70 days",
        yield: "8-15 tons/ha",
        season: "Year-round (avoid extreme heat/frost)",
        price: "15-25 Pula/kg",
        pests: ["Bean Leaf Beetle", "Aphids", "Pod Borers"],
        diseases: ["Bean Common Mosaic Virus", "Rust", "Anthracnose"],
        chemicals: ["Lambda-cyhalothrin", "Seed treatment with Thiram", "Sulfur for rust"],
        description: "A fast-maturing, high-value legume vegetable.",
        careStages: [
            {
                stage: "Sowing & Emergence",
                duration: "5-10 days",
                tasks: ["Direct seed into moist soil", "Inoculate with rhizobia", "Protect from birds"]
            },
            {
                stage: "Flowering",
                duration: "15-20 days",
                tasks: ["Critical moisture period", "Scout for beetles and aphids", "Support for pole varieties"]
            },
            {
                stage: "Picking",
                duration: "15-25 days",
                tasks: ["Harvest every 2-3 days", "Handle carefully to avoid damage", "Cool immediately after harvest"]
            }
        ]
    },
    pumpkin: {
        name: "Pumpkin",
        type: "Vegetable",
        growthTime: "90-120 days",
        yield: "20-40 tons/ha",
        season: "Aug-Dec (Spring-Summer)",
        price: "6-12 Pula/kg",
        pests: ["Fruit Fly", "Squash Bugs", "Aphids"],
        diseases: ["Powdery Mildew", "Downy Mildew", "Bacterial Wilt"],
        chemicals: ["Cypermethrin", "Difenoconazole", "Streptomycin"],
        description: "Versatile crop grown for fruit and leaves, good storage life.",
        careStages: [
            {
                stage: "Planting",
                duration: "7-14 days",
                tasks: ["Plant in mounds", "Warm soil required", "Adequate spacing"]
            },
            {
                stage: "Vine Growth",
                duration: "40-60 days",
                tasks: ["Weed control", "Fertilize at flowering", "Train vines if space limited"]
            },
            {
                stage: "Fruit Development",
                duration: "40-50 days",
                tasks: ["Harvest when rind hard", "Leave stem attached", "Cure in sun before storage"]
            }
        ]
    },
    gem_squash: {
        name: "Gem Squash",
        type: "Vegetable",
        growthTime: "80-100 days",
        yield: "15-25 tons/ha",
        season: "Aug-Jan (Spring-Summer)",
        price: "8-15 Pula/kg",
        pests: ["Fruit Fly", "Aphids", "Spider Mites"],
        diseases: ["Powdery Mildew", "Downy Mildew", "Virus Diseases"],
        chemicals: ["Cypermethrin", "Sulfur dust", "Imidacloprid"],
        description: "Popular Southern African squash variety, usually harvested young.",
        careStages: [
            {
                stage: "Planting & Establishment",
                duration: "10-15 days",
                tasks: ["Plant in warm soil", "Space 1m apart", "Use mulch for moisture retention"]
            },
            {
                stage: "Growth & Flowering",
                duration: "40-50 days",
                tasks: ["Regular watering", "Pollination management", "Pest monitoring"]
            },
            {
                stage: "Harvest",
                duration: "30-40 days",
                tasks: ["Harvest when 5-8cm diameter", "Regular picking encourages production", "Handle carefully to avoid damage"]
            }
        ]
    },
    sweet_corn: {
        name: "Sweet Corn",
        type: "Vegetable",
        growthTime: "60-90 days",
        yield: "8-15 tons/ha",
        season: "Aug-Feb (Warm season)",
        price: "10-20 Pula/dozen",
        pests: ["Maize Stem Borer", "Earworm", "Aphids"],
        diseases: ["Maize Streak Virus", "Common Rust", "Leaf Blight"],
        chemicals: ["Emamectin Benzoate", "Lambda-cyhalothrin", "Mancozeb"],
        description: "Maize variety harvested immature for sweet kernels.",
        careStages: [
            {
                stage: "Planting",
                duration: "7-10 days",
                tasks: ["Isolate from field maize", "Plant in blocks for pollination", "Warm soil required"]
            },
            {
                stage: "Growth",
                duration: "40-60 days",
                tasks: ["Adequate water at tasseling", "Weed control", "Fertilize at knee-high stage"]
            },
            {
                stage: "Harvest",
                duration: "7-10 days",
                tasks: ["Harvest at milk stage", "Cool immediately", "Market quickly for freshness"]
            }
        ]
    },
    amaranth: {
        name: "Amaranth (Imbuya)",
        type: "Leafy Vegetable",
        growthTime: "30-50 days",
        yield: "10-20 tons/ha",
        season: "Year-round",
        price: "12-20 Pula/bunch",
        pests: ["Aphids", "Leafminers", "Caterpillars"],
        diseases: ["Damping-off", "Leaf Spot", "Root Rot"],
        chemicals: ["Neem oil", "Spinosad", "Copper fungicides"],
        description: "Highly nutritious indigenous leafy green, drought-tolerant.",
        careStages: [
            {
                stage: "Establishment",
                duration: "7-10 days",
                tasks: ["Direct seeding", "Thin to 15-20cm apart", "Keep moist for germination"]
            },
            {
                stage: "Leaf Production",
                duration: "20-30 days",
                tasks: ["Harvest leaves regularly", "Light fertilization", "Weed control"]
            },
            {
                stage: "Continuous Harvest",
                duration: "20-40 days",
                tasks: ["Cut leaves 5cm above ground", "Regrows quickly", "Regular watering"]
            }
        ]
    },
    spider_plant: {
        name: "Spider Plant (Cleome)",
        type: "Leafy Vegetable",
        growthTime: "40-60 days",
        yield: "8-15 tons/ha",
        season: "Year-round",
        price: "10-18 Pula/bunch",
        pests: ["Aphids", "Caterpillars", "Flea Beetles"],
        diseases: ["Leaf Spot", "Powdery Mildew", "Damping-off"],
        chemicals: ["Neem extracts", "Spinosad", "Sulfur dust"],
        description: "Traditional leafy vegetable with high nutritional value.",
        careStages: [
            {
                stage: "Germination",
                duration: "10-14 days",
                tasks: ["Light required for germination", "Shallow planting", "Keep soil moist"]
            },
            {
                stage: "Vegetative Growth",
                duration: "20-30 days",
                tasks: ["Thin to 20-25cm apart", "Nitrogen application", "Weed control"]
            },
            {
                stage: "Harvest Period",
                duration: "20-30 days",
                tasks: ["Harvest young leaves and shoots", "Regular picking", "Post-harvest cooling"]
            }
        ]
    },
    citrus: {
        name: "Citrus (Oranges)",
        type: "Fruit Tree",
        growthTime: "3-5 years to fruit",
        yield: "20-50 tons/ha (mature orchard)",
        season: "Varies (e.g., Valencias: Sep-Dec)",
        price: "8-20 Pula/kg",
        pests: ["Citrus Thrips", "False Codling Moth", "Citrus Psylla"],
        diseases: ["Citrus Canker", "Citrus Black Spot", "Greening (Huanglongbing)"],
        chemicals: ["Abamectin", "Phosphates for codling moth", "Copper sprays"],
        description: "Perennial fruit trees requiring year-round management and irrigation.",
        careStages: [
            {
                stage: "Orchard Establishment",
                duration: "1-3 years",
                tasks: ["Plant certified, grafted trees", "Install irrigation system", "Young tree care (staking, feeding)"]
            },
            {
                stage: "Flowering & Fruit Set",
                duration: "2-3 months",
                tasks: ["Ensure good pollination", "Manage water stress", "Control thrips to prevent scarring"]
            },
            {
                stage: "Fruit Development & Harvest",
                duration: "6-12 months",
                tasks: ["Regular irrigation", "Monitor for fruit fly and codling moth", "Harvest at correct maturity index"]
            }
        ]
    },
    mangoes: {
        name: "Mangoes",
        type: "Fruit Tree",
        growthTime: "3-5 years to fruit",
        yield: "10-20 tons/ha",
        season: "Sep-Feb (Main season)",
        price: "10-30 Pula/kg",
        pests: ["Mango Fruit Fly", "Seed Weevil", "Mealybugs"],
        diseases: ["Anthracnose", "Powdery Mildew", "Bacterial Black Spot"],
        chemicals: ["Bait sprays for fruit fly", "Trifloxystrobin", "Wettable sulfur"],
        description: "A popular tropical fruit tree, sensitive to fungal diseases during flowering.",
        careStages: [
            {
                stage: "Flowering",
                duration: "1-2 months",
                tasks: ["Manage anthracnose and powdery mildew", "Avoid water stress", "Encourage pollinator activity"]
            },
            {
                stage: "Fruit Development",
                duration: "3-5 months",
                tasks: ["Thin fruits for size", "Bagging fruits for premium market", "Bait spraying for fruit fly"]
            },
            {
                stage: "Maturation & Harvest",
                duration: "1 month",
                tasks: ["Harvest at mature-green stage", "Careful handling to avoid sap burn", "Post-harvest hot water treatment"]
            }
        ]
    },
    avocados: {
        name: "Avocados",
        type: "Fruit Tree",
        growthTime: "3-4 years to fruit",
        yield: "10-25 tons/ha",
        season: "Mar-Sep (Varies by cultivar)",
        price: "15-40 Pula/kg",
        pests: ["False Codling Moth", "Thrips", "Borer"],
        diseases: ["Root Rot (Phytophthora)", "Anthracnose", "Cercospora Spot"],
        chemicals: ["Phosphites for root rot", "Copper fungicides", "Trunk injections for borers"],
        description: "A high-value export fruit requiring careful water management and disease control.",
        careStages: [
            {
                stage: "Orchard Management",
                duration: "Year-round",
                tasks: ["Mulching to conserve moisture", "Careful irrigation to avoid root rot", "Annual fertilization"]
            },
            {
                stage: "Flowering & Fruit Set",
                duration: "2-3 months",
                tasks: ["Understand A/B flower types", "Wind protection", "Calcium application for fruit quality"]
            },
            {
                stage: "Harvest & Post-Harvest",
                duration: "3-6 months",
                tasks: ["Harvest based on dry matter content", "Careful handling to avoid bruising", "Cooling and ripening management"]
            }
        ]
    },
    bananas: {
        name: "Bananas",
        type: "Fruit",
        growthTime: "12-18 months to first harvest",
        yield: "30-70 tons/ha",
        season: "Year-round",
        price: "8-15 Pula/kg",
        pests: ["Banana Weevil", "Nematodes", "Aphids"],
        diseases: ["Fusarium Wilt (Panama Disease)", "Black Sigatoka", "Banana Bunchy Top Virus"],
        chemicals: ["Nemacur for nematodes", "Sigatoka fungicide rotation", "Remove infected plants for BBTV"],
        description: "A perennial herb producing fruit year-round, requiring high moisture and fertility.",
        careStages: [
            {
                stage: "Sucker Management & Planting",
                duration: "0-6 months",
                tasks: ["Plant tissue culture plants", "Select and manage suckers for ratoon", "Deep planting in well-drained soil"]
            },
            {
                stage: "Vegetative Growth",
                duration: "6-9 months",
                tasks: ["High nitrogen and potassium", "Prophylactic fungicide for Sigatoka", "De-suckering and de-leafing"]
            },
            {
                stage: "Bunch Development & Harvest",
                duration: "3-4 months",
                tasks: ["Propping (supporting) heavy bunches", "Bunch covering", "Harvest at mature-green stage"]
            }
        ]
    },
    papaya: {
        name: "Papaya (Pawpaw)",
        type: "Fruit",
        growthTime: "9-12 months to fruit",
        yield: "30-100 tons/ha",
        season: "Year-round",
        price: "10-20 Pula/kg",
        pests: ["Fruit Fly", "Mites", "Mealybugs"],
        diseases: ["Papaya Ringspot Virus", "Anthracnose", "Damping-off"],
        chemicals: ["Bait sprays", "Chlorothalonil", "Use PRSV-resistant varieties"],
        description: "A fast-growing, short-lived perennial tree, highly susceptible to viruses.",
        careStages: [
            {
                stage: "Nursery & Transplanting",
                duration: "2-3 months",
                tasks: ["Sow multiple seeds per bag", "Transplant carefully to avoid root damage", "Determine sex of seedlings (remove males if desired)"]
            },
            {
                stage: "Rapid Growth & Flowering",
                duration: "4-6 months",
                tasks: ["High fertilization", "Water regularly", "Protect from wind"]
            },
            {
                stage: "Continuous Harvest",
                duration: "12-24 months",
                tasks: ["Harvest frequently", "Color-indicating ripeness", "Manage fruit fly population"]
            }
        ]
    },
    pineapples: {
        name: "Pineapples",
        type: "Fruit",
        growthTime: "18-24 months to fruit",
        yield: "50-100 tons/ha",
        season: "Year-round (forced)",
        price: "12-25 Pula/kg",
        pests: ["Mealybugs", "Nematodes", "Scale Insects"],
        diseases: ["Heart Rot", "Root Rot", "Butt Rot"],
        chemicals: ["Dipping suckers in fungicide", "Nemacur", "Ethephon for forcing"],
        description: "A tropical bromeliad fruit, propagated vegetatively, and often ratooned.",
        careStages: [
            {
                stage: "Land Preparation & Planting",
                duration: "1-2 months",
                tasks: ["Use plastic mulch", "Plant healthy suckers/slips", "Pre-plant nematicide"]
            },
            {
                stage: "Vegetative Growth",
                duration: "12-18 months",
                tasks: ["Nitrogen application", "Weed control", "Protect from mealybugs"]
            },
            {
                stage: "Forcing & Fruit Development",
                duration: "5-7 months",
                tasks: ["Apply ethylene to force flowering", "Boron and potassium application", "Harvest at correct color and brix"]
            }
        ]
    },
    peaches: {
        name: "Peaches",
        type: "Fruit Tree",
        growthTime: "2-3 years to fruit",
        yield: "15-30 tons/ha",
        season: "Oct-Feb (Summer)",
        price: "15-30 Pula/kg",
        pests: ["Fruit Fly", "Oriental Fruit Moth", "Scale Insects"],
        diseases: ["Brown Rot", "Leaf Curl", "Bacterial Spot"],
        chemicals: ["Bait sprays for fruit fly", "Chlorothalonil", "Copper sprays"],
        description: "Deciduous stone fruit requiring winter chilling for proper bud break.",
        careStages: [
            {
                stage: "Dormancy & Pruning",
                duration: "Winter months",
                tasks: ["Prune for open center", "Apply dormant oil", "Winter chilling requirement"]
            },
            {
                stage: "Flowering & Fruit Set",
                duration: "2-3 months",
                tasks: ["Frost protection during bloom", "Thin fruits for size", "Monitor for brown rot"]
            },
            {
                stage: "Fruit Development & Harvest",
                duration: "3-4 months",
                tasks: ["Regular irrigation", "Harvest at correct firmness", "Post-harvest cooling"]
            }
        ]
    },
    guava: {
        name: "Guava",
        type: "Fruit Tree",
        growthTime: "2-3 years to fruit",
        yield: "20-40 tons/ha",
        season: "Year-round with peaks",
        price: "10-20 Pula/kg",
        pests: ["Fruit Fly", "Guava Moth", "Mealybugs"],
        diseases: ["Anthracnose", "Guava Wilt", "Algal Spot"],
        chemicals: ["Bait sprays", "Copper fungicides", "Systemic insecticides"],
        description: "Tropical fruit tree with multiple fruiting seasons, relatively low maintenance.",
        careStages: [
            {
                stage: "Establishment",
                duration: "1-2 years",
                tasks: ["Plant in well-drained soil", "Young tree training", "Regular watering establishment"]
            },
            {
                stage: "Production",
                duration: "Year-round",
                tasks: ["Light pruning after harvest", "Balanced fertilization", "Fruit fly management"]
            }
        ]
    },
    litchi: {
        name: "Litchi/Lychee",
        type: "Fruit Tree",
        growthTime: "3-5 years to fruit",
        yield: "5-15 tons/ha",
        season: "Nov-Jan (Summer)",
        price: "25-50 Pula/kg",
        pests: ["Litchi Mite", "Fruit Borer", "Scale Insects"],
        diseases: ["Anthracnose", "Dieback", "Algal Disease"],
        chemicals: ["Sulfur sprays", "Copper fungicides", "Miticides"],
        description: "Subtropical fruit tree requiring specific climate conditions for flowering.",
        careStages: [
            {
                stage: "Flower Induction",
                duration: "Winter months",
                tasks: ["Cool, dry period required", "Withhold irrigation", "Potassium application"]
            },
            {
                stage: "Fruit Development",
                duration: "3-4 months",
                tasks: ["Regular irrigation during fruit growth", "Bird netting", "Harvest when skin turns pink"]
            }
        ]
    },
    granadilla: {
        name: "Granadilla (Passionfruit)",
        type: "Fruit Vine",
        growthTime: "12-18 months to full production",
        yield: "15-25 tons/ha",
        season: "Year-round with peaks",
        price: "20-40 Pula/kg",
        pests: ["Fruit Fly", "Thrips", "Mites"],
        diseases: ["Fusarium Wilt", "Woodiness Virus", "Brown Spot"],
        chemicals: ["Bait sprays", "Abamectin", "Copper fungicides"],
        description: "Vigorous vine producing aromatic fruits for fresh market and juice.",
        careStages: [
            {
                stage: "Vine Establishment",
                duration: "6-9 months",
                tasks: ["Strong trellis system", "Training vines", "Regular feeding"]
            },
            {
                stage: "Production",
                duration: "2-3 years",
                tasks: ["Hand pollination if needed", "Regular harvest", "Prune to renew growth"]
            }
        ]
    },
    sunflower: {
        name: "Sunflower",
        type: "Oil Seed",
        growthTime: "90-100 days",
        yield: "1-2 tons/ha",
        season: "Nov-Feb",
        price: "10-15 Pula/kg",
        pests: ["Sunflower Moth", "Aphids", "Cutworms"],
        diseases: ["Rust", "Downy Mildew", "Sclerotinia"],
        chemicals: ["Lambda-cyhalothrin", "Carbendazim", "Mancozeb"],
        description: "Drought-tolerant oil seed crop suitable for dry regions.",
        careStages: [
            {
                stage: "Germination",
                duration: "7-10 days",
                tasks: ["Well-drained soil", "Plant 2-3cm deep", "Adequate moisture"]
            },
            {
                stage: "Vegetative",
                duration: "30-40 days",
                tasks: ["Weed control", "Thinning", "Fertilizer application"]
            },
            {
                stage: "Flowering",
                duration: "20-30 days",
                tasks: ["Pollination support", "Pest monitoring", "Water management"]
            },
            {
                stage: "Maturation",
                duration: "30-40 days",
                tasks: ["Bird control", "Harvest planning", "Drying preparation"]
            }
        ]
    },
    cinnamon: {
        name: "Cinnamon",
        type: "Spice Crop",
        growthTime: "2-3 years to first harvest",
        yield: "2-4 tons/ha (bark)",
        season: "Year-round (harvest after rains)",
        price: "50-100 Pula/kg",
        pests: ["Cinnamon Butterfly", "Scale Insects", "Borers"],
        diseases: ["Leaf Spot", "Dieback", "Root Rot"],
        chemicals: ["Neem oil", "Copper fungicides", "Systemic insecticides"],
        description: "Tropical spice crop grown for its aromatic bark, requires specific processing.",
        careStages: [
            {
                stage: "Nursery & Establishment",
                duration: "1-2 years",
                tasks: ["Shade in early growth", "Regular watering", "Mulching"]
            },
            {
                stage: "Growth Phase",
                duration: "1-2 years",
                tasks: ["Prune for multiple stems", "Organic matter application", "Weed control"]
            },
            {
                stage: "Harvest & Processing",
                duration: "Continuous after maturity",
                tasks: ["Coppice stems at base", "Strip bark carefully", "Ferment and dry properly"]
            }
        ]
    },
    cotton: {
        name: "Cotton",
        type: "Fiber Crop",
        growthTime: "150-180 days",
        yield: "1-3 tons/ha (seed cotton)",
        season: "Nov-Apr (Summer)",
        price: "Market Dependent",
        pests: ["Bollworm", "Aphids", "Jassids"],
        diseases: ["Bacterial Blight", "Fusarium Wilt", "Verticillium Wilt"],
        chemicals: ["Pyrethroids", "Acetamiprid", "Streptomycin for blight"],
        description: "A major fiber crop requiring a long, hot growing season.",
        careStages: [
            {
                stage: "Establishment",
                duration: "30-40 days",
                tasks: ["Plant when soil is warm", "Control early season thrips", "Ensure good stand establishment"]
            },
            {
                stage: "Square & Boll Formation",
                duration: "70-90 days",
                tasks: ["Intensive pest scouting for bollworms", "Balanced nutrition", "Avoid water stress during flowering"]
            },
            {
                stage: "Boll Opening & Harvest",
                duration: "40-50 days",
                tasks: ["Stop pesticide use pre-harvest", "Apply defoliant if necessary", "Pick in multiple rounds"]
            }
        ]
    },
    sugarcane: {
        name: "Sugarcane",
        type: "Cash Crop",
        growthTime: "12-18 months",
        yield: "80-120 tons/ha",
        season: "Year-round (Plant Feb-Apr)",
        price: "Contract with Mill",
        pests: ["Eldana Borer", "Termites", "Scale Insects"],
        diseases: ["Smut", "Leaf Scald", "Ratoon Stunting Disease"],
        chemicals: ["Chlorpyrifos for borer", "Systemic insecticides", "Heat therapy for seed cane"],
        description: "A perennial grass grown for sugar and biofuel, with multiple harvests (ratoons).",
        careStages: [
            {
                stage: "Planting",
                duration: "30-45 days",
                tasks: ["Use disease-free seed cane", "Furrow planting", "Adequate irrigation"]
            },
            {
                stage: "Grand Growth Period",
                duration: "6-9 months",
                tasks: ["High nitrogen requirement", "Weed control", "Monitor for borer"]
            },
            {
                stage: "Ripening & Harvest",
                duration: "2-3 months",
                tasks: ["Withhold irrigation to build sugar", "Burn field before harvest (if practiced)", "Cut at soil level for good ratooning"]
            }
        ]
    },
    tea: {
        name: "Tea",
        type: "Beverage Crop",
        growthTime: "3-5 years to full production",
        yield: "2-4 tons/ha (made tea)",
        season: "Year-round (peaks in rainy season)",
        price: "Market Dependent",
        pests: ["Tea Mosquito Bug", "Red Spider Mite", "Aphids"],
        diseases: ["Blister Blight", "Brown Blight", "Root Rot"],
        chemicals: ["Copper fungicides", "Acaricides", "Pruning to manage disease"],
        description: "An evergreen shrub grown for its leaves, requiring acidic soils and high rainfall.",
        careStages: [
            {
                stage: "Plucking Table Formation",
                duration: "1-3 years",
                tasks: ["Formative pruning", "Shade tree establishment", "Acidify soil if necessary"]
            },
            {
                stage: "Continuous Harvest (Plucking)",
                duration: "Year-round for decades",
                tasks: ["Pluck 'two leaves and a bud'", "Regular fertilizer application", "Prune on a 3-4 year cycle"]
            }
        ]
    },
    coffee: {
        name: "Coffee (Arabica)",
        type: "Beverage Crop",
        growthTime: "3-4 years to fruit",
        yield: "1-2 tons/ha (green bean)",
        season: "Apr-Aug (Harvest)",
        price: "Market Dependent",
        pests: ["Coffee Berry Borer", "Leaf Miner", "Antestia Bug"],
        diseases: ["Coffee Leaf Rust", "Coffee Berry Disease", "Fusarium Bark Disease"],
        chemicals: ["Beauveria bassiana for CBB", "Copper fungicides", "Stem scraping for CBD"],
        description: "A high-value perennial shrub for higher altitudes, sensitive to temperature and disease.",
        careStages: [
            {
                stage: "Orchard Establishment",
                duration: "1-3 years",
                tasks: ["Provide shade trees", "Correct soil pH", "Training to single or multiple stems"]
            },
            {
                stage: "Flowering & Fruit Set",
                duration: "2-3 months",
                tasks: ["Manage water after dry period to induce flowering", "Protect flowers from rain", "Monitor for Antestia bug"]
            },
            {
                stage: "Berry Development & Processing",
                duration: "8-9 months",
                tasks: ["Multiple selective harvests", "Control Berry Borer rigorously", "Process (wet/dry) promptly after harvest"]
            }
        ]
    },
    chillies: {
        name: "Chillies",
        type: "Vegetable",
        growthTime: "80-120 days",
        yield: "5-15 tons/ha (fresh)",
        season: "Year-round under irrigation",
        price: "20-50 Pula/kg",
        pests: ["Thrips", "Aphids", "Fruit Borer"],
        diseases: ["Damping-off", "Bacterial Leaf Spot", "Powdery Mildew"],
        chemicals: ["Fipronil", "Streptomycin for bacterial spot", "Wettable sulfur"],
        description: "A high-value spice crop, with varying levels of pungency (heat).",
        careStages: [
            {
                stage: "Nursery",
                duration: "4-5 weeks",
                tasks: ["Bottom heat for germination", "Good ventilation to prevent damping-off", "Harden off seedlings"]
            },
            {
                stage: "Flowering & Fruit Set",
                duration: "30-40 days",
                tasks: ["Even moisture to prevent flower drop", "Calcium to prevent blossom end rot", "Control thrips for fruit quality"]
            },
            {
                stage: "Continuous Picking",
                duration: "2-4 months",
                tasks: ["Harvest regularly to encourage flowering", "Wear gloves when handling hot varieties", "Grade for size and color"]
            }
        ]
    },
    garlic: {
        name: "Garlic",
        type: "Vegetable",
        growthTime: "120-150 days",
        yield: "5-10 tons/ha",
        season: "Mar-Aug (Winter)",
        price: "40-80 Pula/kg",
        pests: ["Thrips", "Onion Maggot", "Nematodes"],
        diseases: ["Purple Blotch", "White Rot", "Rust"],
        chemicals: ["Spinosad", "Seed clove treatment", "Fungicide dips"],
        description: "A high-value bulb crop requiring a cool period for proper bulbing.",
        careStages: [
            {
                stage: "Planting",
                duration: "0-30 days",
                tasks: ["Plant individual cloves", "Use virus-free seed stock", "Well-drained soil is essential"]
            },
            {
                stage: "Leaf Growth",
                duration: "60-80 days",
                tasks: ["Cool temperatures are ideal", "Nitrogen application", "Keep weed-free"]
            },
            {
                stage: "Bulb Formation & Curing",
                duration: "30-40 days",
                tasks: ["Stop watering before harvest", "Lift bulbs carefully", "Cure in a warm, dry, ventilated area for 2-3 weeks"]
            }
        ]
    },
    safflower: {
        name: "Safflower",
        type: "Oil Seed",
        growthTime: "120-150 days",
        yield: "1-2.5 tons/ha (seed)",
        season: "May-Jul (Winter) / Nov-Feb (Summer in cooler areas)",
        price: "15-25 Pula/kg",
        pests: ["Safflower Fly", "Aphids", "Thrips"],
        diseases: ["Alternaria Leaf Spot", "Fusarium Wilt", "Rust"],
        chemicals: ["Dimethoate", "Azoxystrobin", "Carbendazim"],
        description: "A drought-tolerant oilseed crop, also grown for birdseed and as a cut flower. Its deep taproot makes it excellent for breaking hardpans.",
        careStages: [
            {
                stage: "Germination & Rosette",
                duration: "30-45 days",
                tasks: ["Plant in well-drained soil", "Shallow sowing (2-4 cm)", "Ensure good seedbed moisture for establishment"]
            },
            {
                stage: "Stem Elongation & Branching",
                duration: "40-50 days",
                tasks: ["Thin to desired plant density", "Control weeds before canopy closure", "Apply phosphorus-rich fertilizer"]
            },
            {
                stage: "Flowering & Seed Set",
                duration: "30-40 days",
                tasks: ["Avoid overhead irrigation to prevent disease", "Monitor for aphids and thrips", "Ensure good pollination"]
            },
            {
                stage: "Maturation & Harvest",
                duration: "20-30 days",
                tasks: ["Allow plants to dry completely in the field", "Harvest when stems are brittle and seeds loose", "Use combine with careful settings to avoid seed loss"]
            }
        ]
    },
    green_peppers: {
        name: "Green Peppers (Bell Peppers/Capsicum)",
        type: "Vegetable",
        growthTime: "70-90 days to first harvest",
        yield: "20-40 tons/ha",
        season: "Year-round under irrigation (avoid frost)",
        price: "12-25 Pula/kg",
        pests: ["Aphids", "Thrips", "Fruit Borer"],
        diseases: ["Bacterial Spot", "Powdery Mildew", "Phytophthora Blight"],
        chemicals: ["Acetamiprid", "Spiromesifen", "Copper-based bactericides"],
        description: "A high-value vegetable from the Capsicum family, prized for its mild flavor and crisp texture. Requires consistent warmth and careful nutrient management.",
        careStages: [
            {
                stage: "Nursery & Transplanting",
                duration: "5-7 weeks",
                tasks: ["Start seeds in trays at 25-28¬∞C", "Transplant after 5-6 true leaves", "Harden off seedlings before transplanting"]
            },
            {
                stage: "Vegetative Growth & Early Flowering",
                duration: "4-5 weeks",
                tasks: ["Staking or trellising for support", "Apply balanced fertilizer", "Ensure even moisture to prevent blossom end rot"]
            },
            {
                stage: "Fruit Set & Development",
                duration: "8-12 weeks",
                tasks: ["Harvest green peppers when full-sized and firm", "Side-dress with potassium", "Regular, targeted pesticide applications for borer control"]
            }
        ]
    },
    lablab: {
        name: "Lablab (Hyacinth Bean)",
        type: "Legume",
        growthTime: "90-120 days (for dry beans)",
        yield: "1-2.5 tons/ha (dry beans), 15-30 tons/ha (fodder)",
        season: "Oct-Mar (Summer)",
        price: "10-18 Pula/kg (dry beans)",
        pests: ["Aphids", "Pod Borers", "Flower Thrips"],
        diseases: ["Cercospora Leaf Spot", "Powdery Mildew", "Root Rot"],
        chemicals: ["Imidacloprid", "Emamectin Benzoate", "Wettable Sulfur"],
        description: "An extremely drought-tolerant and versatile legume used for human consumption (beans), forage, and as a green manure cover crop.",
        careStages: [
            {
                stage: "Establishment",
                duration: "10-15 days",
                tasks: ["Inoculate seeds with specific rhizobia", "Plant in warm soil after rains begin", "Can be sown densely for forage or spaced for grain"]
            },
            {
                stage: "Vine Growth & Flowering",
                duration: "50-70 days",
                tasks: ["Provide trellising for climbing varieties", "Control weeds until canopy closes", "Phosphorus application crucial for good yield"]
            },
            {
                stage: "Podding & Maturation",
                duration: "30-40 days",
                tasks: ["For fresh beans, harvest when pods are tender", "For dry beans, allow pods to dry on the vine", "Thresh carefully as seeds can be fragile"]
            }
        ]
    }
};
// =============================================
// PREMIUM CROP DATABASE (Activated Users Only)
// =============================================

const premiumCrops = {
    avocado: {
        name: "Avocado",
        type: "Fruit",
        growthTime: "2-3 years to fruit",
        yield: "10-20 tons/ha",
        season: "Year-round (tropical)",
        price: "15-25 Pula/kg",
        pests: ["Fruit Fly", "Root Rot", "Borer Beetles"],
        diseases: ["Anthracnose", "Root Rot", "Sunblotch"],
        chemicals: ["Copper fungicides", "Phosphonic acid", "Imidacloprid"],
        description: "High-value export crop with growing international demand. Requires well-drained soil.",
        premium: true,
        careStages: [
            {
                stage: "Establishment",
                duration: "1-2 years",
                tasks: ["Plant in well-drained soil", "Space trees 6-8m apart", "Install irrigation"]
            },
            {
                stage: "Growth",
                duration: "2-3 years",
                tasks: ["Regular pruning", "Fertilize quarterly", "Weed control"]
            },
            {
                stage: "Production",
                duration: "20+ years",
                tasks: ["Harvest when mature", "Post-harvest treatment", "Quality sorting"]
            }
        ]
    },
    coffee: {
        name: "Coffee Arabica",
        type: "Beverage Crop",
        growthTime: "3-4 years to harvest",
        yield: "1-2 tons/ha green beans",
        season: "Harvest: May-August",
        price: "40-60 Pula/kg",
        pests: ["Coffee Berry Borer", "Leaf Miner", "Mealybugs"],
        diseases: ["Coffee Leaf Rust", "Coffee Wilt", "Berry Disease"],
        chemicals: ["Triadimenol", "Copper oxychloride", "Cypermethrin"],
        description: "Premium specialty crop with high export value. Grows best in high altitudes.",
        premium: true,
        careStages: [
            {
                stage: "Nursery",
                duration: "6-12 months",
                tasks: ["Shade management", "Regular watering", "Pest monitoring"]
            },
            {
                stage: "Field Establishment",
                duration: "2-3 years",
                tasks: ["Transplanting", "Shade trees", "Training pruning"]
            },
            {
                stage: "Production",
                duration: "15-20 years",
                tasks: ["Selective harvesting", "Processing", "Quality grading"]
            }
        ]
    },
    macadamia: {
        name: "Macadamia Nuts",
        type: "Nut Crop",
        growthTime: "4-5 years to harvest",
        yield: "3-4 tons/ha in-shell",
        season: "Harvest: March-July",
        price: "25-40 Pula/kg",
        pests: ["Nut Borer", "Stink Bugs", "Rats"],
        diseases: ["Husk Spot", "Root Rot", "Blossom Blight"],
        chemicals: ["Chlorpyrifos", "Carbendazim", "Mancozeb"],
        description: "Luxury nut crop with excellent export potential and long productive life.",
        premium: true,
        careStages: [
            {
                stage: "Orchard Setup",
                duration: "1-2 years",
                tasks: ["Soil preparation", "Wind breaks", "Irrigation system"]
            },
            {
                stage: "Tree Development",
                duration: "3-4 years",
                tasks: ["Training pruning", "Nutrient management", "Weed control"]
            },
            {
                stage: "Mature Production",
                duration: "40+ years",
                tasks: ["Mechanical harvesting", "Drying processing", "Quality control"]
            }
        ]
    }
};
// =============================================
// MARKET DATA FOR PREMIUM USERS
// =============================================

const marketData = {
    maize: { 
        current: 6.5, 
        trend: "‚Üë", 
        lastWeek: 6.2,
        demand: "High",
        season: "Peak"
    },
    tomatoes: { 
        current: 12.8, 
        trend: "‚Üì", 
        lastWeek: 13.5,
        demand: "Medium", 
        season: "Off"
    },
    sunflower: { 
        current: 14.2, 
        trend: "‚Üí", 
        lastWeek: 14.1,
        demand: "High",
        season: "Peak"
    },
    avocado: {
        current: 18.5,
        trend: "‚Üë",
        lastWeek: 17.8,
        demand: "Very High",
        season: "Year-round"
    },
    coffee: {
        current: 45.0,
        trend: "‚Üë",
        lastWeek: 43.5,
        demand: "High",
        season: "Export"
    }
};
function loadCropGuideContent() {
    return `
        <h2>üå± Crop Guide</h2>
        <p>Browse our comprehensive crop database with growing information, pest management, and best practices.</p>
        <div class="form-group">
            <label for="cropSelector">Select Crop:</label>
            <select id="cropSelector" onchange="showCropDetails()">
                <option value="">-- Choose a crop --</option>
            </select>
        </div>
        <div id="cropDetails" style="display: none;">
            <!-- Crop details will be loaded here -->
        </div>
    `;
}

function loadCropGuide() {
    const cropSelector = getElement('cropSelector');
    if (!cropSelector) return;
    
    cropSelector.innerHTML = '<option value="">-- Choose a crop --</option>';
    
    for (const [key, crop] of Object.entries(cropDatabase)) {
        const option = document.createElement('option');
        option.value = key;
        option.textContent = crop.name;
        cropSelector.appendChild(option);
    }
}

function showCropDetails() {
    const cropSelector = getElement('cropSelector');
    const detailsDiv = getElement('cropDetails');
    
    if (!cropSelector || !detailsDiv) return;
    
    const cropKey = cropSelector.value;
    if (!cropKey) {
        detailsDiv.style.display = 'none';
        return;
    }
    
    const crop = cropDatabase[cropKey];
    detailsDiv.innerHTML = `
        <h3>${crop.name} Details</h3>
        <p>${crop.description}</p>
        
        <div class="detail-section">
            <h4>Growth Information</h4>
            <p><strong>Type:</strong> ${crop.type}</p>
            <p><strong>Growth Time:</strong> ${crop.growthTime}</p>
            <p><strong>Yield:</strong> ${crop.yield}</p>
            <p><strong>Planting Season:</strong> ${crop.season}</p>
            <p><strong>Market Price:</strong> ${crop.price}</p>
        </div>
        
        <div class="detail-section">
            <h4>Crop Care Stages</h4>
            ${crop.careStages.map(stage => `
                <div class="care-stage">
                    <h5>${stage.stage} (${stage.duration})</h5>
                    <ul>
                        ${stage.tasks.map(task => `<li>${task}</li>`).join('')}
                    </ul>
                </div>
            `).join('')}
        </div>
        
        <div class="detail-section">
            <h4>Common Pests</h4>
            <ul>
                ${crop.pests.map(pest => `<li>${pest}</li>`).join('')}
            </ul>
        </div>
        
        <div class="detail-section">
            <h4>Common Diseases</h4>
            <ul>
                ${crop.diseases.map(disease => `<li>${disease}</li>`).join('')}
            </ul>
        </div>
        
        <div class="detail-section">
            <h4>Recommended Chemicals</h4>
            <ul>
                ${crop.chemicals.map(chemical => `<li>${chemical}</li>`).join('')}
            </ul>
        </div>
    `;
    
    detailsDiv.style.display = 'block';
}

// =============================================
// MY CROPS FUNCTIONS
// =============================================

function loadMyCropsContent() {
    return `
        <h2>üåæ My Crops</h2>
        <p>Manage your currently planted crops and track their growth progress.</p>
        
        <div class="grid-2">
            <div>
                <h3>Plant New Crop</h3>
                <div class="form-group">
                    <label for="plantCropType">Crop Type:</label>
                    <select id="plantCropType">
                        <option value="">Select Crop</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="plantArea">Area (hectares):</label>
                    <input type="number" id="plantArea" placeholder="Enter area">
                </div>
                <div class="form-group">
                    <label for="plantDate">Planting Date:</label>
                    <input type="date" id="plantDate">
                </div>
                <button onclick="plantCrop()" class="btn-harvest">Plant Crop</button>
            </div>
            <div>
                <h3>Planted Crops</h3>
                <div id="plantedCropsList" style="max-height: 400px; overflow-y: auto;">
                    <!-- Planted crops will be listed here -->
                </div>
            </div>
        </div>
    `;
}

function loadMyCrops() {
    const plantCropSelector = getElement('plantCropType');
    const plantedCropsList = getElement('plantedCropsList');
    
    if (!plantCropSelector || !plantedCropsList) return;
    
    // Populate crop selector
    plantCropSelector.innerHTML = '<option value="">Select Crop</option>';
    for (const [key, crop] of Object.entries(cropDatabase)) {
        const option = document.createElement('option');
        option.value = key;
        option.textContent = crop.name;
        plantCropSelector.appendChild(option);
    }
    
    // Set default date to today
    const plantDate = getElement('plantDate');
    if (plantDate) {
        plantDate.valueAsDate = new Date();
    }
    
    // Load planted crops
    plantedCropsList.innerHTML = '';
    
    if (farmData.plantedCrops.length === 0) {
        plantedCropsList.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">No crops planted yet</div>';
        return;
    }
    
    farmData.plantedCrops.forEach((crop, index) => {
        const cropInfo = cropDatabase[crop.type];
        if (!cropInfo) return;
        
        const plantedDate = new Date(crop.plantedDate);
        const growthDays = parseInt(cropInfo.growthTime.split('-')[0]);
        const harvestDate = new Date(plantedDate.getTime() + (growthDays * 24 * 60 * 60 * 1000));
        const today = new Date();
        
        // Calculate progress
        const totalGrowthTime = harvestDate - plantedDate;
        const elapsedTime = today - plantedDate;
        const progress = Math.min(Math.max((elapsedTime / totalGrowthTime) * 100, 0), 100);
        
        // Calculate expected yield
        const yieldRange = cropInfo.yield.split('-');
        const minYield = parseFloat(yieldRange[0]);
        const maxYield = parseFloat(yieldRange[1]);
        const expectedYield = ((minYield + maxYield) / 2) * crop.area;
        
        const cropCard = document.createElement('div');
        cropCard.className = 'planted-crop-card';
        cropCard.innerHTML = `
            <h3>${cropInfo.name}</h3>
            <div class="muted">Planted on ${plantedDate.toLocaleDateString()}</div>
            <div><strong>Area:</strong> ${crop.area} hectares</div>
            <div><strong>Expected Harvest:</strong> ${harvestDate.toLocaleDateString()}</div>
            <div><strong>Expected Yield:</strong> ${expectedYield.toFixed(1)} tons</div>
            
            <div class="crop-status">
                <div>Growth Progress</div>
                <div>${Math.round(progress)}%</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill-bar" style="width: ${progress}%">${Math.round(progress)}%</div>
            </div>
            
            <button onclick="harvestCrop(${index})" class="small" style="margin-top: 0.5rem;">Harvest</button>
        `;
        
        plantedCropsList.appendChild(cropCard);
    });
}

function plantCrop() {
    const cropTypeInput = getElement('plantCropType');
    const areaInput = getElement('plantArea');
    const dateInput = getElement('plantDate');
    
    if (!cropTypeInput || !areaInput || !dateInput) return;
    
    const cropType = cropTypeInput.value;
    const area = parseFloat(areaInput.value);
    const plantedDate = dateInput.value;
    
    if (!cropType || !area || !plantedDate) {
        showNotification('Please fill all fields');
        return;
    }
    
    if (area <= 0) {
        showNotification('Please enter a valid area');
        return;
    }
    
    const newCrop = {
        type: cropType,
        area: area,
        plantedDate: plantedDate
    };
    
    farmData.plantedCrops.push(newCrop);
    safeSaveData();
    loadMyCrops();
    updateDashboard();
    
    // Clear form
    cropTypeInput.value = '';
    areaInput.value = '';
    dateInput.value = '';
    
    showNotification('Crop planted successfully!');
}

function harvestCrop(index) {
    if (confirm('Are you sure you want to mark this crop as harvested?')) {
        farmData.plantedCrops.splice(index, 1);
        safeSaveData();
        loadMyCrops();
        updateDashboard();
        showNotification('Crop harvested successfully!');
    }
}

// =============================================
// INVENTORY FUNCTIONS
// =============================================

function loadInventoryContent() {
    return `
        <h2>üì¶ Inventory Management</h2>
        <div class="grid-2">
            <div>
                <h3>Add New Product</h3>
                <div class="form-group">
                    <label for="productName">Product Name:</label>
                    <input type="text" id="productName" placeholder="Enter product name">
                </div>
                <div class="form-group">
                    <label for="productCategory">Category:</label>
                    <select id="productCategory">
                        <option value="seeds">Seeds</option>
                        <option value="fertilizers">Fertilizers</option>
                        <option value="tools">Tools</option>
                        <option value="equipment">Equipment</option>
                        <option value="produce">Produce</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="productQuantity">Quantity:</label>
                    <input type="number" id="productQuantity" placeholder="Enter quantity">
                </div>
                <div class="form-group">
                    <label for="productPrice">Price (Pula):</label>
                    <input type="number" id="productPrice" step="0.01" placeholder="Enter price">
                </div>
                <button onclick="addProduct()">Add Product</button>
            </div>
            <div>
                <h3>Current Inventory</h3>
                <div id="inventoryList" style="max-height: 400px; overflow-y: auto;">
                    <!-- Inventory items will be loaded here -->
                </div>
            </div>
        </div>
    `;
}

function loadInventory() {
    const inventoryList = getElement('inventoryList');
    if (!inventoryList) return;
    
    inventoryList.innerHTML = '';
    
    if (!farmData.inventory) farmData.inventory = [];
    
    farmData.inventory.forEach((item, index) => {
        let itemClass = 'inventory-item';
        if (item.quantity === 0) itemClass += ' out-of-stock';
        else if (item.quantity < 10) itemClass += ' low-stock';
        
        const itemElement = document.createElement('div');
        itemElement.className = itemClass;
        itemElement.innerHTML = `
            <h4>${item.name}</h4>
            <div class="muted">${item.category}</div>
            <div><strong>Quantity:</strong> ${item.quantity}</div>
            <div><strong>Price:</strong> ${item.price.toFixed(2)} Pula</div>
            <div><strong>Value:</strong> ${(item.quantity * item.price).toFixed(2)} Pula</div>
            <button onclick="removeProduct(${index})" class="small btn-outline" style="margin-top: 0.5rem;">Remove</button>
        `;
        inventoryList.appendChild(itemElement);
    });
    
    if (inventoryList.children.length === 0) {
        inventoryList.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">No inventory items</div>';
    }
}

function addProduct() {
    const name = getElement('productName')?.value.trim();
    const category = getElement('productCategory')?.value;
    const quantity = parseInt(getElement('productQuantity')?.value);
    const price = parseFloat(getElement('productPrice')?.value);
    
    if (!name || isNaN(quantity) || quantity < 0 || isNaN(price) || price < 0) {
        showNotification('Please fill all fields correctly.');
        return;
    }
    
    if (!farmData.inventory) farmData.inventory = [];
    
    farmData.inventory.push({
        name: name,
        category: category,
        quantity: quantity,
        price: price,
        added: new Date().toISOString()
    });
    
    if (safeSaveData()) {
        loadInventory();
        getElement('productName').value = '';
        getElement('productQuantity').value = '';
        getElement('productPrice').value = '';
        showNotification('Product added!');
    } else {
        farmData.inventory.pop();
        showNotification('Failed to save product.', 'error');
    }
}

function removeProduct(index) {
    if (confirm('Remove this product?')) {
        farmData.inventory.splice(index, 1);
        if (safeSaveData()) {
            loadInventory();
            showNotification('Product removed!');
        } else {
            showNotification('Failed to remove product.', 'error');
        }
    }
}

// =============================================
// POS FUNCTIONS
// =============================================

function loadPOSContent() {
    return `
        <h2>üõí Point of Sale</h2>
        <div class="grid-2">
            <div>
                <h3>Products</h3>
                <div id="posProductsList" style="max-height: 400px; overflow-y: auto;">
                    <!-- Products will be loaded here -->
                </div>
            </div>
            <div>
                <h3>Shopping Cart</h3>
                <div id="posCart" style="max-height: 300px; overflow-y: auto; margin-bottom: 1rem;">
                    <!-- Cart items will be loaded here -->
                </div>
                <div style="border-top: 2px solid #eee; padding-top: 1rem;">
                    <div style="display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: bold; margin-bottom: 1rem;">
                        <span>Total:</span>
                        <span id="cartTotal">0.00 Pula</span>
                    </div>
                    <div style="display: flex; gap: 0.5rem;">
                        <button onclick="clearCart()" class="btn-outline" style="flex: 1;">Clear Cart</button>
                        <button id="completeSaleBtn" onclick="completeSale()" style="flex: 2;" disabled>Complete Sale</button>
                    </div>
                </div>
            </div>
        </div>
    `;
}

function loadPOSProducts() {
    const productsList = getElement('posProductsList');
    if (!productsList) return;
    
    productsList.innerHTML = '';
    
    farmData.inventory.forEach((product, index) => {
        if (product.quantity > 0) {
            const productElement = document.createElement('div');
            productElement.className = 'pos-item';
            productElement.innerHTML = `
                <div>
                    <strong>${product.name}</strong>
                    <div class="muted">${product.category} ‚Ä¢ ${product.quantity} in stock</div>
                </div>
                <div><strong>${product.price.toFixed(2)} Pula</strong></div>
            `;
            productElement.onclick = () => addToCart(index);
            productsList.appendChild(productElement);
        }
    });
    
    if (productsList.children.length === 0) {
        productsList.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">No products available</div>';
    }
    
    updateCartDisplay();
}

function addToCart(productIndex) {
    const product = farmData.inventory[productIndex];
    if (!product) return;
    
    const existingItem = posCart.find(item => item.productIndex === productIndex);
    
    if (existingItem) {
        if (existingItem.quantity < product.quantity) {
            existingItem.quantity++;
        } else {
            showNotification('Not enough stock');
            return;
        }
    } else {
        posCart.push({
            productIndex: productIndex,
            name: product.name,
            price: product.price,
            quantity: 1
        });
    }
    
    updateCartDisplay();
}

function updateCartDisplay() {
    const cartElement = getElement('posCart');
    const totalElement = getElement('cartTotal');
    const completeBtn = getElement('completeSaleBtn');
    
    if (!cartElement || !totalElement || !completeBtn) return;
    
    if (posCart.length === 0) {
        cartElement.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">Cart is empty</div>';
        totalElement.textContent = '0.00 Pula';
        completeBtn.disabled = true;
        return;
    }
    
    let total = 0;
    cartElement.innerHTML = '';
    
    posCart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        
        const cartItem = document.createElement('div');
        cartItem.className = 'cart-item';
        cartItem.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <strong>${item.name}</strong>
                    <div>${item.price.toFixed(2)} Pula √ó ${item.quantity}</div>
                </div>
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <strong>${itemTotal.toFixed(2)} Pula</strong>
                    <button onclick="removeFromCart(${index})" class="small btn-outline">‚úï</button>
                </div>
            </div>
        `;
        cartElement.appendChild(cartItem);
    });
    
    totalElement.textContent = `${total.toFixed(2)} Pula`;
    completeBtn.disabled = false;
}

function removeFromCart(index) {
    posCart.splice(index, 1);
    updateCartDisplay();
}

function clearCart() {
    if (posCart.length === 0) return;
    
    if (confirm('Clear all items from cart?')) {
        posCart = [];
        updateCartDisplay();
    }
}

function completeSale() {
    if (posCart.length === 0) {
        showNotification('Cart is empty');
        return;
    }
    
    // Calculate total
    const total = posCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    
    // Update inventory and record sale
    posCart.forEach(item => {
        const product = farmData.inventory[item.productIndex];
        if (product) {
            product.quantity -= item.quantity;
        }
    });
    
    // Record sale
    const sale = {
        items: [...posCart],
        total: total,
        date: new Date().toISOString(),
        id: 'S' + Date.now()
    };
    
    if (!farmData.sales) farmData.sales = [];
    farmData.sales.push(sale);
    
    // Update finance balance
    farmData.finances.balance += total;
    
    if (safeSaveData()) {
        showNotification(`Sale completed! Total: ${total.toFixed(2)} Pula`, 'success');
        posCart = [];
        updateCartDisplay();
        loadPOSProducts();
        updateDashboard();
    } else {
        showNotification('Failed to complete sale', 'error');
    }
}

// =============================================
// FINANCE FUNCTIONS
// =============================================

function loadFinanceContent() {
    return `
        <h2>üí∞ Financial Management</h2>
        <div class="grid-2">
            <div>
                <h3>Record Income</h3>
                <div class="form-group">
                    <label for="incomeAmount">Amount (Pula):</label>
                    <input type="number" id="incomeAmount" step="0.01" placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label for="incomeSource">Source:</label>
                    <input type="text" id="incomeSource" placeholder="Income source">
                </div>
                <div class="form-group">
                    <label for="incomeDate">Date:</label>
                    <input type="date" id="incomeDate">
                </div>
                <button onclick="recordIncome()">Record Income</button>
            </div>
            <div>
                <h3>Record Expense</h3>
                <div class="form-group">
                    <label for="expenseAmount">Amount (Pula):</label>
                    <input type="number" id="expenseAmount" step="0.01" placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label for="expenseCategory">Category:</label>
                    <select id="expenseCategory">
                        <option value="seeds">Seeds</option>
                        <option value="fertilizers">Fertilizers</option>
                        <option value="labor">Labor</option>
                        <option value="equipment">Equipment</option>
                        <option value="fuel">Fuel</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="expenseDate">Date:</label>
                    <input type="date" id="expenseDate">
                </div>
                <button onclick="recordExpense()">Record Expense</button>
            </div>
        </div>
        
        <div style="margin-top: 2rem;">
            <h3>Financial Summary</h3>
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Current Balance</h3>
                    <div class="value">${farmData.finances.balance.toFixed(2)} Pula</div>
                </div>
                <div class="dashboard-card">
                    <h3>Total Income</h3>
                    <div class="value" id="totalIncome">0 Pula</div>
                </div>
                <div class="dashboard-card">
                    <h3>Total Expenses</h3>
                    <div class="value" id="totalExpenses">0 Pula</div>
                </div>
            </div>
        </div>
        
        <div style="margin-top: 2rem;">
            <h3>Recent Transactions</h3>
            <div id="recentTransactions">
                <!-- Transactions will be loaded here -->
            </div>
        </div>
    `;
}

function loadFinanceData() {
    // Set default dates to today
    const incomeDate = getElement('incomeDate');
    const expenseDate = getElement('expenseDate');
    if (incomeDate) incomeDate.valueAsDate = new Date();
    if (expenseDate) expenseDate.valueAsDate = new Date();
    
    // Calculate totals
    const totalIncome = farmData.finances.income.reduce((sum, item) => sum + item.amount, 0);
    const totalExpenses = farmData.finances.expenses.reduce((sum, item) => sum + item.amount, 0);
    
    const totalIncomeElement = getElement('totalIncome');
    const totalExpensesElement = getElement('totalExpenses');
    
    if (totalIncomeElement) totalIncomeElement.textContent = `${totalIncome.toFixed(2)} Pula`;
    if (totalExpensesElement) totalExpensesElement.textContent = `${totalExpenses.toFixed(2)} Pula`;
    
    // Load recent transactions
    const recentTransactions = getElement('recentTransactions');
    if (!recentTransactions) return;
    
    const allTransactions = [
        ...farmData.finances.income.map(t => ({...t, type: 'income'})),
        ...farmData.finances.expenses.map(t => ({...t, type: 'expense'}))
    ].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10);
    
    if (allTransactions.length === 0) {
        recentTransactions.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">No transactions yet</div>';
        return;
    }
    
    recentTransactions.innerHTML = `
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Type</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                ${allTransactions.map(transaction => `
                    <tr>
                        <td>${new Date(transaction.date).toLocaleDateString()}</td>
                        <td>${transaction.source || transaction.category}</td>
                        <td>
                            <span class="${transaction.type === 'income' ? 'status-active' : 'status-danger'}">
                                ${transaction.type === 'income' ? 'Income' : 'Expense'}
                            </span>
                        </td>
                        <td>${transaction.amount.toFixed(2)} Pula</td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    `;
}

function recordIncome() {
    const amount = parseFloat(getElement('incomeAmount')?.value);
    const source = getElement('incomeSource')?.value.trim();
    const date = getElement('incomeDate')?.value;
    
    if (!amount || amount <= 0 || !source || !date) {
        showNotification('Please fill all fields correctly.');
        return;
    }
    
    const income = {
        amount: amount,
        source: source,
        date: date,
        id: 'I' + Date.now()
    };
    
    farmData.finances.income.push(income);
    farmData.finances.balance += amount;
    
    if (safeSaveData()) {
        showNotification('Income recorded!');
        getElement('incomeAmount').value = '';
        getElement('incomeSource').value = '';
        loadFinanceData();
        updateDashboard();
    } else {
        farmData.finances.income.pop();
        farmData.finances.balance -= amount;
        showNotification('Failed to record income.', 'error');
    }
}

function recordExpense() {
    const amount = parseFloat(getElement('expenseAmount')?.value);
    const category = getElement('expenseCategory')?.value;
    const date = getElement('expenseDate')?.value;
    
    if (!amount || amount <= 0 || !category || !date) {
        showNotification('Please fill all fields correctly.');
        return;
    }
    
    const expense = {
        amount: amount,
        category: category,
        date: date,
        id: 'E' + Date.now()
    };
    
    farmData.finances.expenses.push(expense);
    farmData.finances.balance -= amount;
    
    if (safeSaveData()) {
        showNotification('Expense recorded!');
        getElement('expenseAmount').value = '';
        loadFinanceData();
        updateDashboard();
    } else {
        farmData.finances.expenses.pop();
        farmData.finances.balance += amount;
        showNotification('Failed to record expense.', 'error');
    }
}

// =============================================
// CLIENT MANAGEMENT FUNCTIONS
// =============================================

function loadClientsContent() {
    return `
        <h2>üë• Client Management</h2>
        <div class="grid-2">
            <div>
                <h3>Add New Client</h3>
                <div class="form-group">
                    <label for="clientName">Client Name:</label>
                    <input type="text" id="clientName" placeholder="Enter client name">
                </div>
                <div class="form-group">
                    <label for="clientContact">Contact Number:</label>
                    <input type="text" id="clientContact" placeholder="Enter contact number">
                </div>
                <div class="form-group">
                    <label for="clientEmail">Email:</label>
                    <input type="email" id="clientEmail" placeholder="Enter email">
                </div>
                <div class="form-group">
                    <label for="clientType">Client Type:</label>
                    <select id="clientType">
                        <option value="buyer">Buyer</option>
                        <option value="supplier">Supplier</option>
                        <option value="partner">Partner</option>
                    </select>
                </div>
                <button onclick="addClient()">Add Client</button>
            </div>
            <div>
                <h3>Client List</h3>
                <div id="clientsList" style="max-height: 400px; overflow-y: auto;">
                    <!-- Clients will be loaded here -->
                </div>
            </div>
        </div>
    `;
}

function loadClients() {
    const clientsList = getElement('clientsList');
    if (!clientsList) return;
    
    clientsList.innerHTML = '';
    
    if (!farmData.clients) farmData.clients = [];
    
    farmData.clients.forEach((client, index) => {
        const clientElement = document.createElement('div');
        clientElement.className = 'client-card';
        clientElement.innerHTML = `
            <h4>${client.name}</h4>
            <div class="muted">${client.type} ‚Ä¢ ${client.contact}</div>
            ${client.email ? `<div>${client.email}</div>` : ''}
            <button onclick="removeClient(${index})" class="small btn-outline" style="margin-top: 0.5rem;">Remove</button>
        `;
        clientsList.appendChild(clientElement);
    });
    
    if (clientsList.children.length === 0) {
        clientsList.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">No clients added yet</div>';
    }
}

function addClient() {
    const name = getElement('clientName')?.value.trim();
    const contact = getElement('clientContact')?.value.trim();
    const email = getElement('clientEmail')?.value.trim();
    const type = getElement('clientType')?.value;
    
    if (!name || !contact || !type) {
        showNotification('Please fill all required fields.');
        return;
    }
    
    if (!farmData.clients) farmData.clients = [];
    
    farmData.clients.push({
        name: name,
        contact: contact,
        email: email,
        type: type,
        added: new Date().toISOString()
    });
    
    if (safeSaveData()) {
        showNotification('Client added!');
        getElement('clientName').value = '';
        getElement('clientContact').value = '';
        getElement('clientEmail').value = '';
        loadClients();
    } else {
        farmData.clients.pop();
        showNotification('Failed to add client.', 'error');
    }
}

function removeClient(index) {
    if (confirm('Remove this client?')) {
        farmData.clients.splice(index, 1);
        if (safeSaveData()) {
            loadClients();
            showNotification('Client removed!');
        } else {
            showNotification('Failed to remove client.', 'error');
        }
    }
}

// =============================================
// TASK MANAGEMENT FUNCTIONS
// =============================================

function loadTasksContent() {
    return `
        <h2>üìã Task Management</h2>
        <div class="grid-2">
            <div>
                <h3>Add New Task</h3>
                <div class="form-group">
                    <label for="taskTitle">Task Title:</label>
                    <input type="text" id="taskTitle" placeholder="Enter task title">
                </div>
                <div class="form-group">
                    <label for="taskDescription">Description:</label>
                    <textarea id="taskDescription" placeholder="Enter task description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="taskPriority">Priority:</label>
                    <select id="taskPriority">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="taskDueDate">Due Date:</label>
                    <input type="date" id="taskDueDate">
                </div>
                <button onclick="addTask()">Add Task</button>
            </div>
            <div>
                <h3>Task List</h3>
                <div id="tasksList" style="max-height: 400px; overflow-y: auto;">
                    <!-- Tasks will be loaded here -->
                </div>
            </div>
        </div>
    `;
}

function loadTasks() {
    const tasksList = getElement('tasksList');
    if (!tasksList) return;
    
    tasksList.innerHTML = '';
    
    if (!farmData.tasks) farmData.tasks = [];
    
    // Set default due date to today
    const taskDueDate = getElement('taskDueDate');
    if (taskDueDate) {
        taskDueDate.valueAsDate = new Date();
    }
    
    farmData.tasks.forEach((task, index) => {
        const priorityClass = task.priority === 'high' ? 'status-danger' : 
                            task.priority === 'medium' ? 'status-warning' : 'status-active';
        
        const taskElement = document.createElement('div');
        taskElement.className = 'task-card';
        taskElement.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: start;">
                <div style="flex: 1;">
                    <h4>${task.title}</h4>
                    ${task.description ? `<p>${task.description}</p>` : ''}
                    <div class="muted">Due: ${new Date(task.dueDate).toLocaleDateString()}</div>
                    <span class="${priorityClass}">${task.priority.toUpperCase()}</span>
                </div>
                <div style="display: flex; gap: 0.5rem; margin-left: 1rem;">
                    <button onclick="toggleTaskCompletion(${index})" class="small ${task.completed ? 'btn-outline' : ''}">
                        ${task.completed ? 'Undo' : 'Complete'}
                    </button>
                    <button onclick="removeTask(${index})" class="small btn-outline">‚úï</button>
                </div>
            </div>
            ${task.completed ? '<div class="status-active">‚úì Completed</div>' : ''}
        `;
        tasksList.appendChild(taskElement);
    });
    
    if (tasksList.children.length === 0) {
        tasksList.innerHTML = '<div style="text-align: center; padding: 2rem; color: var(--muted);">No tasks added yet</div>';
    }
}

function addTask() {
    const title = getElement('taskTitle')?.value.trim();
    const description = getElement('taskDescription')?.value.trim();
    const priority = getElement('taskPriority')?.value;
    const dueDate = getElement('taskDueDate')?.value;
    
    if (!title || !dueDate) {
        showNotification('Please fill all required fields.');
        return;
    }
    
    if (!farmData.tasks) farmData.tasks = [];
    
    farmData.tasks.push({
        title: title,
        description: description,
        priority: priority,
        dueDate: dueDate,
        completed: false,
        created: new Date().toISOString()
    });
    
    if (safeSaveData()) {
        showNotification('Task added!');
        getElement('taskTitle').value = '';
        getElement('taskDescription').value = '';
        loadTasks();
        updateDashboard();
    } else {
        farmData.tasks.pop();
        showNotification('Failed to add task.', 'error');
    }
}

function toggleTaskCompletion(index) {
    farmData.tasks[index].completed = !farmData.tasks[index].completed;
    if (safeSaveData()) {
        loadTasks();
        updateDashboard();
        showNotification(farmData.tasks[index].completed ? 'Task completed!' : 'Task marked as incomplete');
    } else {
        farmData.tasks[index].completed = !farmData.tasks[index].completed;
        showNotification('Failed to update task.', 'error');
    }
}

function removeTask(index) {
    if (confirm('Remove this task?')) {
        farmData.tasks.splice(index, 1);
        if (safeSaveData()) {
            loadTasks();
            updateDashboard();
            showNotification('Task removed!');
        } else {
            showNotification('Failed to remove task.', 'error');
        }
    }
}

// =============================================
// REPORTS FUNCTIONS
// =============================================

function loadReportsContent() {
    return `
        <h2>üìä Reports & Analytics</h2>
        
        <div class="report-period-selector">
            <button class="period-btn ${currentReportPeriod === 'weekly' ? 'active' : ''}" onclick="setReportPeriod('weekly')">Weekly</button>
            <button class="period-btn ${currentReportPeriod === 'monthly' ? 'active' : ''}" onclick="setReportPeriod('monthly')">Monthly</button>
            <button class="period-btn ${currentReportPeriod === 'quarterly' ? 'active' : ''}" onclick="setReportPeriod('quarterly')">Quarterly</button>
            <button class="period-btn ${currentReportPeriod === 'yearly' ? 'active' : ''}" onclick="setReportPeriod('yearly')">Yearly</button>
            <button class="period-btn" onclick="showCustomDateRange()">Custom</button>
        </div>
        
        <div id="customDateRange">
            <div class="form-group">
                <label for="startDate">Start Date:</label>
                <input type="date" id="startDate">
            </div>
            <div class="form-group">
                <label for="endDate">End Date:</label>
                <input type="date" id="endDate">
            </div>
            <button onclick="generateCustomReport()">Generate Custom Report</button>
        </div>
        
        <div class="grid-2" style="margin-top: 2rem;">
            <div>
                <h3>Financial Report</h3>
                <div id="financialReport">
                    <!-- Financial report will be loaded here -->
                </div>
            </div>
            <div>
                <h3>Sales Report</h3>
                <div id="salesReport">
                    <!-- Sales report will be loaded here -->
                </div>
            </div>
        </div>
        
        <div style="margin-top: 2rem;">
            <h3>Inventory Report</h3>
            <div id="inventoryReport">
                <!-- Inventory report will be loaded here -->
            </div>
        </div>
    `;
}

function setReportPeriod(period) {
    currentReportPeriod = period;
    generateReports();
}

function showCustomDateRange() {
    const customDateRange = getElement('customDateRange');
    if (customDateRange) {
        customDateRange.style.display = 'block';
    }
}

function setupCustomDateRange() {
    const startDate = getElement('startDate');
    const endDate = getElement('endDate');
    
    if (startDate && endDate) {
        const today = new Date();
        endDate.valueAsDate = today;
        startDate.valueAsDate = new Date(today.getTime() - 30 * 24 * 60 * 60 * 1000); // 30 days ago
    }
}

function generateCustomReport() {
    const startDate = getElement('startDate')?.value;
    const endDate = getElement('endDate')?.value;
    
    if (!startDate || !endDate) {
        showNotification('Please select both start and end dates.');
        return;
    }
    
    if (new Date(startDate) > new Date(endDate)) {
        showNotification('Start date cannot be after end date.');
        return;
    }
    
    currentReportPeriod = 'custom';
    generateReports(startDate, endDate);
}

function generateReports(startDate = null, endDate = null) {
    generateFinancialReport(startDate, endDate);
    generateSalesReport(startDate, endDate);
    generateInventoryReport();
}

function generateFinancialReport(startDate = null, endDate = null) {
    const financialReport = getElement('financialReport');
    if (!financialReport) return;
    
    let income = 0;
    let expenses = 0;
    
    // Calculate income and expenses for the period
    farmData.finances.income.forEach(item => {
        const itemDate = new Date(item.date);
        if (isInPeriod(itemDate, startDate, endDate)) {
            income += item.amount;
        }
    });
    
    farmData.finances.expenses.forEach(item => {
        const itemDate = new Date(item.date);
        if (isInPeriod(itemDate, startDate, endDate)) {
            expenses += item.amount;
        }
    });
    
    const profit = income - expenses;
    
    financialReport.innerHTML = `
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <h3>Total Income</h3>
                <div class="value">${income.toFixed(2)} Pula</div>
            </div>
            <div class="dashboard-card">
                <h3>Total Expenses</h3>
                <div class="value">${expenses.toFixed(2)} Pula</div>
            </div>
            <div class="dashboard-card">
                <h3>Net Profit</h3>
                <div class="value ${profit >= 0 ? 'positive' : 'negative'}">${profit.toFixed(2)} Pula</div>
            </div>
        </div>
    `;
}

function generateSalesReport(startDate = null, endDate = null) {
    const salesReport = getElement('salesReport');
    if (!salesReport) return;
    
    let totalSales = 0;
    let salesCount = 0;
    
    farmData.sales.forEach(sale => {
        const saleDate = new Date(sale.date);
        if (isInPeriod(saleDate, startDate, endDate)) {
            totalSales += sale.total;
            salesCount++;
        }
    });
    
    const averageSale = salesCount > 0 ? totalSales / salesCount : 0;
    
    salesReport.innerHTML = `
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <h3>Total Sales</h3>
                <div class="value">${totalSales.toFixed(2)} Pula</div>
            </div>
            <div class="dashboard-card">
                <h3>Number of Sales</h3>
                <div class="value">${salesCount}</div>
            </div>
            <div class="dashboard-card">
                <h3>Average Sale</h3>
                <div class="value">${averageSale.toFixed(2)} Pula</div>
            </div>
        </div>
    `;
}

function generateInventoryReport() {
    const inventoryReport = getElement('inventoryReport');
    if (!inventoryReport) return;
    
    const totalValue = farmData.inventory.reduce((sum, item) => sum + (item.quantity * item.price), 0);
    const totalItems = farmData.inventory.reduce((sum, item) => sum + item.quantity, 0);
    const lowStockItems = farmData.inventory.filter(item => item.quantity > 0 && item.quantity < 10).length;
    const outOfStockItems = farmData.inventory.filter(item => item.quantity === 0).length;
    
    inventoryReport.innerHTML = `
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <h3>Total Inventory Value</h3>
                <div class="value">${totalValue.toFixed(2)} Pula</div>
            </div>
            <div class="dashboard-card">
                <h3>Total Items</h3>
                <div class="value">${totalItems}</div>
            </div>
            <div class="dashboard-card">
                <h3>Low Stock Items</h3>
                <div class="value ${lowStockItems > 0 ? 'negative' : 'positive'}">${lowStockItems}</div>
            </div>
            <div class="dashboard-card">
                <h3>Out of Stock</h3>
                <div class="value ${outOfStockItems > 0 ? 'negative' : 'positive'}">${outOfStockItems}</div>
            </div>
        </div>
    `;
}

function isInPeriod(date, startDate, endDate) {
    if (!startDate || !endDate) {
        // Default to current period based on currentReportPeriod
        const now = new Date();
        let periodStart, periodEnd;
        
        switch(currentReportPeriod) {
            case 'weekly':
                periodStart = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                periodEnd = now;
                break;
            case 'monthly':
                periodStart = new Date(now.getFullYear(), now.getMonth(), 1);
                periodEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0);
                break;
            case 'quarterly':
                const quarter = Math.floor(now.getMonth() / 3);
                periodStart = new Date(now.getFullYear(), quarter * 3, 1);
                periodEnd = new Date(now.getFullYear(), (quarter + 1) * 3, 0);
                break;
            case 'yearly':
                periodStart = new Date(now.getFullYear(), 0, 1);
                periodEnd = new Date(now.getFullYear(), 11, 31);
                break;
            default:
                return true; // Show all for unknown periods
        }
        
        return date >= periodStart && date <= periodEnd;
    }
    
    // Custom date range
    const start = new Date(startDate);
    const end = new Date(endDate);
    return date >= start && date <= end;
}
// =============================================
// PREMIUM CONTENT FUNCTIONS
// =============================================

function loadPremiumContent() {
    return `
        <div style="text-align: center; margin-bottom: 2rem;">
            <div style="font-size: 3rem; margin-bottom: 0.5rem;">‚≠ê</div>
            <h1 style="color: var(--primary);">FarmPro Premium</h1>
            <p>Advanced tools and features to maximize your farm's potential</p>
        </div>

        <div class="dashboard-grid">
            <div class="dashboard-card" onclick="openPremiumSection('analytics')" style="cursor: pointer;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìà</div>
                <h3>Advanced Analytics</h3>
                <p>Profitability scores, yield predictions, and performance insights</p>
            </div>
            
            <div class="dashboard-card" onclick="openPremiumSection('market')" style="cursor: pointer;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üåç</div>
                <h3>Market Intelligence</h3>
                <p>Real-time prices, demand trends, and opportunity alerts</p>
            </div>
            
            <div class="dashboard-card" onclick="openPremiumSection('premiumCrops')" style="cursor: pointer;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üå±</div>
                <h3>Premium Crops</h3>
                <p>High-value crops like avocado, coffee, and macadamia</p>
            </div>
            
            <div class="dashboard-card" onclick="openPremiumSection('financialTools')" style="cursor: pointer;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üí∞</div>
                <h3>Financial Tools</h3>
                <p>Loan calculators, break-even analysis, and ROI tools</p>
            </div>
            
            <div class="dashboard-card" onclick="openPremiumSection('reports')" style="cursor: pointer;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìä</div>
                <h3>Smart Reports</h3>
                <p>Automated reporting and data export features</p>
            </div>
            
            <div class="dashboard-card" onclick="openPremiumSection('resources')" style="cursor: pointer;">
                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìö</div>
                <h3>Premium Resources</h3>
                <p>Best practice guides and success strategies</p>
            </div>
        </div>

        <div id="premiumSectionContent" style="margin-top: 2rem;">
            <!-- Premium sections will load here when clicked -->
        </div>
    `;
}

function openPremiumSection(section) {
    const contentArea = getElement('premiumSectionContent');
    if (!contentArea) return;

    switch(section) {
        case 'analytics':
            contentArea.innerHTML = loadPremiumAnalytics();
            break;
        case 'market':
            contentArea.innerHTML = loadMarketIntelligence();
            break;
        case 'premiumCrops':
            contentArea.innerHTML = loadPremiumCrops();
            break;
        case 'financialTools':
            contentArea.innerHTML = loadFinancialTools();
            break;
        case 'reports':
            contentArea.innerHTML = loadPremiumReports();
            break;
        case 'resources':
            contentArea.innerHTML = loadPremiumResources();
            break;
    }
}
function loadPremiumAnalytics() {
    const profitability = calculateProfitability();
    
    return `
        <h2>üìà Advanced Analytics</h2>
        
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <h3>Profitability Score</h3>
                <div class="value" style="color: ${profitability >= 80 ? 'var(--primary)' : profitability >= 60 ? 'var(--warning)' : 'var(--danger)'};">${profitability}%</div>
                <div class="change ${profitability >= 80 ? 'positive' : 'negative'}">
                    ${profitability >= 80 ? 'Excellent' : profitability >= 60 ? 'Good' : 'Needs Improvement'}
                </div>
            </div>
            
            <div class="dashboard-card">
                <h3>Crop Health Index</h3>
                <div class="value">${Math.min(100, farmData.plantedCrops.length * 15 + 40)}%</div>
                <div class="change positive">Based on ${farmData.plantedCrops.length} active crops</div>
            </div>
            
            <div class="dashboard-card">
                <h3>Resource Efficiency</h3>
                <div class="value">${Math.min(100, farmData.inventory.length * 8 + 50)}%</div>
                <div class="change positive">${farmData.inventory.length} inventory items</div>
            </div>
            
            <div class="dashboard-card">
                <h3>Task Completion</h3>
                <div class="value">${farmData.tasks.length > 0 ? Math.round((farmData.tasks.filter(t => t.completed).length / farmData.tasks.length) * 100) : 100}%</div>
                <div class="change positive">${farmData.tasks.filter(t => t.completed).length}/${farmData.tasks.length} tasks done</div>
            </div>
        </div>
        
        <div style="margin-top: 2rem; background: #f8f9fa; padding: 1.5rem; border-radius: 8px;">
            <h3>üéØ Recommendations</h3>
            <p>${profitability >= 80 ? 
                'Your farm is performing excellently! Consider expanding with premium crops.' : 
                profitability >= 60 ? 
                'Good performance. Focus on cost optimization and yield improvement.' : 
                'Review your expenses and consider diversifying crops for better returns.'
            }</p>
        </div>
    `;
}

function calculateProfitability() {
    if (!farmData.plantedCrops.length) return 75;
    
    const totalInvestment = farmData.finances.expenses.reduce((sum, exp) => sum + exp.amount, 0);
    const totalRevenue = farmData.finances.income.reduce((sum, inc) => sum + inc.amount, 0);
    
    if (totalInvestment === 0) return totalRevenue > 0 ? 100 : 75;
    const rawScore = (totalRevenue / totalInvestment) * 100;
    return Math.min(100, Math.max(25, Math.round(rawScore)));
}

function loadMarketIntelligence() {
    return `
        <h2>üåç Market Intelligence</h2>
        
        <div style="background: #fff3cd; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem; border-left: 4px solid #ffc107;">
            <strong>üí° Opportunity Alert:</strong> Avocado and coffee prices are rising with high demand. Consider these premium crops for maximum returns.
        </div>
        
        <div class="dashboard-grid">
            ${Object.entries(marketData).map(([crop, data]) => `
                <div class="dashboard-card">
                    <h3>${crop.charAt(0).toUpperCase() + crop.slice(1)}</h3>
                    <div class="value">${data.current} Pula/kg</div>
                    <div class="change ${data.trend === '‚Üë' ? 'positive' : data.trend === '‚Üì' ? 'negative' : ''}">
                        ${data.trend} from ${data.lastWeek} last week
                    </div>
                    <div style="margin-top: 0.5rem; font-size: 0.9rem;">
                        <strong>Demand:</strong> ${data.demand}<br>
                        <strong>Season:</strong> ${data.season}
                    </div>
                </div>
            `).join('')}
        </div>
        
        <div style="margin-top: 2rem; background: #e8f5e8; padding: 1.5rem; border-radius: 8px;">
            <h3>üìà Market Trends</h3>
            <p><strong>Rising:</strong> Avocado, Coffee, Sunflower - Good time to plant</p>
            <p><strong>Stable:</strong> Maize - Reliable staple crop</p>
            <p><strong>Declining:</strong> Tomatoes - Consider reducing production</p>
        </div>
    `;
}

function loadPremiumCrops() {
    return `
        <h2>üå± Premium Crops</h2>
        <p>High-value crops with excellent export potential and profitability.</p>
        
        <div class="grid-2">
            ${Object.entries(premiumCrops).map(([key, crop]) => `
                <div class="dashboard-card">
                    <h3>${crop.name}</h3>
                    <div class="muted">${crop.type} ‚Ä¢ ${crop.growthTime}</div>
                    <div><strong>Yield:</strong> ${crop.yield}</div>
                    <div><strong>Price:</strong> ${crop.price}</div>
                    <div><strong>Season:</strong> ${crop.season}</div>
                    
                    <div style="margin-top: 1rem;">
                        <strong>Best For:</strong>
                        <ul style="margin: 0.5rem 0; padding-left: 1.2rem;">
                            <li>Export markets</li>
                            <li>Long-term investment</li>
                            <li>High-profit margins</li>
                        </ul>
                    </div>
                    
                    <button onclick="showCropDetail('${key}')" class="small" style="margin-top: 0.5rem;">View Details</button>
                </div>
            `).join('')}
        </div>
    `;
}

function showCropDetail(cropKey) {
    const crop = premiumCrops[cropKey];
    const contentArea = getElement('premiumSectionContent');
    
    contentArea.innerHTML = `
        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 1rem;">
            <button onclick="openPremiumSection('premiumCrops')" class="small btn-outline">‚Üê Back to Premium Crops</button>
            <h2 style="margin: 0 auto;">${crop.name}</h2>
        </div>
        
        <div style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="color: var(--primary); margin-bottom: 1rem;">${crop.name} Farming Guide</h3>
            <p>${crop.description}</p>
            
            <div class="grid-2" style="margin-top: 1.5rem;">
                <div>
                    <h4>Growth Information</h4>
                    <p><strong>Type:</strong> ${crop.type}</p>
                    <p><strong>Growth Time:</strong> ${crop.growthTime}</p>
                    <p><strong>Yield:</strong> ${crop.yield}</p>
                    <p><strong>Season:</strong> ${crop.season}</p>
                    <p><strong>Market Price:</strong> ${crop.price}</p>
                </div>
                
                <div>
                    <h4>Crop Care Stages</h4>
                    ${crop.careStages.map(stage => `
                        <div style="background: #f8f9fa; padding: 0.8rem; border-radius: 6px; margin: 0.5rem 0; border-left: 3px solid var(--primary);">
                            <strong>${stage.stage}</strong> (${stage.duration})
                            <ul style="margin: 0.5rem 0; padding-left: 1.2rem;">
                                ${stage.tasks.map(task => `<li>${task}</li>`).join('')}
                            </ul>
                        </div>
                    `).join('')}
                </div>
            </div>
            
            <div class="grid-2" style="margin-top: 1.5rem;">
                <div>
                    <h4>Common Pests</h4>
                    <ul>
                        ${crop.pests.map(pest => `<li>${pest}</li>`).join('')}
                    </ul>
                </div>
                
                <div>
                    <h4>Recommended Chemicals</h4>
                    <ul>
                        ${crop.chemicals.map(chemical => `<li>${chemical}</li>`).join('')}
                    </ul>
                </div>
            </div>
        </div>
    `;
}

function loadFinancialTools() {
    return `
        <h2>üí∞ Financial Tools</h2>
        
        <div class="grid-2">
            <div>
                <h3>Loan Calculator</h3>
                <div class="form-group">
                    <label for="loanAmount">Loan Amount (Pula):</label>
                    <input type="number" id="loanAmount" placeholder="e.g., 50000">
                </div>
                <div class="form-group">
                    <label for="loanTerm">Term (months):</label>
                    <input type="number" id="loanTerm" placeholder="e.g., 24">
                </div>
                <div class="form-group">
                    <label for="interestRate">Interest Rate (%):</label>
                    <input type="number" id="interestRate" step="0.1" placeholder="e.g., 12.5">
                </div>
                <button onclick="calculateLoanPayment()">Calculate Payment</button>
                <div id="loanResult" style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 6px; display: none;"></div>
            </div>
            
            <div>
                <h3>Break-Even Analysis</h3>
                <div class="form-group">
                    <label for="fixedCosts">Fixed Costs (Pula):</label>
                    <input type="number" id="fixedCosts" placeholder="e.g., 10000">
                </div>
                <div class="form-group">
                    <label for="pricePerUnit">Price per Unit (Pula):</label>
                    <input type="number" id="pricePerUnit" step="0.01" placeholder="e.g., 8.5">
                </div>
                <div class="form-group">
                    <label for="variableCost">Variable Cost per Unit (Pula):</label>
                    <input type="number" id="variableCost" step="0.01" placeholder="e.g., 3.2">
                </div>
                <button onclick="calculateBreakEven()">Calculate Break-Even</button>
                <div id="breakEvenResult" style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 6px; display: none;"></div>
            </div>
        </div>
    `;
}

function loadPremiumReports() {
    const report = generatePremiumReport();
    return `
        <h2>üìä Smart Reports</h2>
        
        <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
            <strong>üìà Automated Reporting:</strong> Your farm performance is automatically analyzed daily. Download reports for meetings with banks or partners.
        </div>
        
        ${report}
        
        <div style="margin-top: 2rem;">
            <h3>Export Options</h3>
            <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                <button onclick="exportToExcel()" class="btn-harvest">üìä Export to Excel</button>
                <button onclick="generatePDFReport()" class="btn-outline">üìÑ Generate PDF Report</button>
            </div>
        </div>
    `;
}

function loadPremiumResources() {
    return `
        <h2>üìö Premium Resources</h2>
        
        <div class="grid-2">
            <div>
                <h3>üå± Best Practice Guides</h3>
                <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <strong>Avocado Farming Guide</strong><br>
                    Complete guide to successful avocado production and export
                </div>
                <div style="background: #e8f5e8; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <strong>High-Value Crop Selection</strong><br>
                    Choosing the right crops for maximum profit in your region
                </div>
                <div style="background: #fff3cd; padding: 1rem; border-radius: 8px;">
                    <strong>Financial Management</strong><br>
                    Budgeting and cost control strategies for commercial farming
                </div>
            </div>
            
            <div>
                <h3>üìÖ Planning Tools</h3>
                <div style="background: #f3e5f5; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <strong>Annual Planting Calendar</strong><br>
                    Optimal planting dates for all major and premium crops
                </div>
                <div style="background: #e0f2f1; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                    <strong>Pest Management Schedule</strong><br>
                    Seasonal pest control recommendations and timing
                </div>
                <div style="background: #fce4ec; padding: 1rem; border-radius: 8px;">
                    <strong>Harvest Planning Guide</strong><br>
                    Timing and techniques for optimal harvest quality
                </div>
            </div>
        </div>
    `;
}

function generatePremiumReport() {
    const profitability = calculateProfitability();
    const inventoryValue = farmData.inventory.reduce((sum, item) => sum + (item.quantity * item.price), 0);
    const completedTasks = farmData.tasks.filter(task => task.completed).length;
    const totalTasks = farmData.tasks.length;
    
    return `
        <div style="background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="color: var(--primary); text-align: center; margin-bottom: 1.5rem;">Farm Performance Report - ${new Date().toLocaleDateString()}</h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
                <div style="text-align: center; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 2rem; color: var(--primary);">${profitability}%</div>
                    <div>Profitability Score</div>
                </div>
                <div style="text-align: center; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 2rem; color: var(--primary);">${farmData.plantedCrops.length}</div>
                    <div>Active Crops</div>
                </div>
                <div style="text-align: center; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 2rem; color: var(--primary);">P ${inventoryValue.toFixed(0)}</div>
                    <div>Inventory Value</div>
                </div>
                <div style="text-align: center; padding: 1rem; background: #f8f9fa; border-radius: 8px;">
                    <div style="font-size: 2rem; color: ${completedTasks/totalTasks >= 0.8 ? 'var(--primary)' : 'var(--warning)'};">${totalTasks > 0 ? Math.round((completedTasks/totalTasks)*100) : 100}%</div>
                    <div>Task Completion</div>
                </div>
            </div>
            
            <div style="background: #e8f5e8; padding: 1rem; border-radius: 8px;">
                <h4 style="margin-bottom: 0.5rem;">üìà Performance Insights</h4>
                <p>${profitability >= 80 ? 
                    'Your farm is performing excellently! Consider expanding with premium crops for even higher returns.' : 
                    profitability >= 60 ? 
                    'Good performance. Focus on optimizing input costs and exploring new market opportunities.' : 
                    'Review your crop selection and input costs. Consider consulting with our agricultural experts.'
                }</p>
            </div>
        </div>
    `;
}

// Financial calculator functions
function calculateLoanPayment() {
    const amount = parseFloat(getElement('loanAmount')?.value);
    const months = parseInt(getElement('loanTerm')?.value);
    const rate = parseFloat(getElement('interestRate')?.value);
    
    if (!amount || !months || !rate) {
        showNotification('Please fill all loan fields');
        return;
    }
    
    const monthlyRate = rate / 100 / 12;
    const payment = amount * monthlyRate * Math.pow(1 + monthlyRate, months) / (Math.pow(1 + monthlyRate, months) - 1);
    const totalPayment = payment * months;
    const totalInterest = totalPayment - amount;
    
    getElement('loanResult').innerHTML = `
        <strong>Monthly Payment:</strong> P ${payment.toFixed(2)}<br>
        <strong>Total Payment:</strong> P ${totalPayment.toFixed(2)}<br>
        <strong>Total Interest:</strong> P ${totalInterest.toFixed(2)}<br>
        <strong>Payoff Date:</strong> ${new Date(new Date().getTime() + months * 30 * 24 * 60 * 60 * 1000).toLocaleDateString()}
    `;
    getElement('loanResult').style.display = 'block';
}

function calculateBreakEven() {
    const fixedCosts = parseFloat(getElement('fixedCosts')?.value);
    const price = parseFloat(getElement('pricePerUnit')?.value);
    const variableCost = parseFloat(getElement('variableCost')?.value);
    
    if (!fixedCosts || !price || !variableCost) {
        showNotification('Please fill all break-even fields');
        return;
    }
    
    if (price <= variableCost) {
        showNotification('Price must be greater than variable cost', 'error');
        return;
    }
    
    const breakEvenUnits = fixedCosts / (price - variableCost);
    const breakEvenRevenue = breakEvenUnits * price;
    
    getElement('breakEvenResult').innerHTML = `
        <strong>Break-Even Units:</strong> ${Math.ceil(breakEvenUnits)} units<br>
        <strong>Break-Even Revenue:</strong> P ${breakEvenRevenue.toFixed(2)}<br>
        <strong>Profit per Unit:</strong> P ${(price - variableCost).toFixed(2)}<br>
        <em>You need to sell ${Math.ceil(breakEvenUnits)} units to cover all costs</em>
    `;
    getElement('breakEvenResult').style.display = 'block';
}

function exportToExcel() {
    let csvContent = "FarmPro Data Export\n\n";
    
    // Crops
    csvContent += "Planted Crops\n";
    csvContent += "Type,Area (ha),Planted Date\n";
    farmData.plantedCrops.forEach(crop => {
        csvContent += `${crop.type},${crop.area},${crop.plantedDate}\n`;
    });
    
    csvContent += "\nInventory\n";
    csvContent += "Name,Category,Quantity,Price,Value\n";
    farmData.inventory.forEach(item => {
        csvContent += `${item.name},${item.category},${item.quantity},${item.price},${item.quantity * item.price}\n`;
    });
    
    // Create download link
    const blob = new Blob([csvContent], { type: 'text/csv' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `farmpro-export-${new Date().toISOString().split('T')[0]}.csv`;
    a.click();
    
    showNotification("üìä Data exported to CSV successfully!", "success");
}

function generatePDFReport() {
    showNotification("üìÑ PDF report generation would be implemented with a PDF library", "info");
}

/// =============================================
// ACTIVATION CODE GENERATION SYSTEM
// =============================================

function generateActivationCode(farmName, hectares) {
    // Convert farm name to uppercase and remove spaces
    const cleanName = farmName.toUpperCase().replace(/\s+/g, '');
    
    // Convert each letter to number and concatenate
    let digitString = '';
    for (let i = 0; i < cleanName.length; i++) {
        const char = cleanName[i];
        if (char >= 'A' && char <= 'Z') {
            const digit = (char.charCodeAt(0) - 64).toString();
            digitString += digit;
        }
    }
    
    // Multiply by hectares
    const numberValue = parseInt(digitString);
    const product = numberValue * hectares;
    
    // Take first 8 digits, pad with zeros if needed
    let codeDigits = product.toString();
    if (codeDigits.length < 8) {
        codeDigits = codeDigits.padEnd(8, '0');
    } else if (codeDigits.length > 8) {
        codeDigits = codeDigits.substring(0, 8);
    }
    
    // Add prefix and suffix
    return `HH${codeDigits}HH`;
}

function showActivationModal() {
    const modal = getElement('activationModal');
    const farmInfo = getElement('farmInfo');
    
    if (modal && farmInfo && farmProfile) {
        // Show user their details to send to support
        farmInfo.innerHTML = `
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary); margin-bottom: 1rem;">
                <h4 style="margin-bottom: 10px; color: var(--primary);">üìã Your Farm Details (Send to Support):</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; font-size: 0.95rem;">
                    <div><strong>Farm Name:</strong></div>
                    <div>${farmProfile.farmName}</div>
                    
                    <div><strong>Hectares:</strong></div>
                    <div>${farmProfile.hectares}</div>
                    
                    <div><strong>Farmer Name:</strong></div>
                    <div>${farmProfile.farmerName}</div>
                    
                    <div><strong>Contact:</strong></div>
                    <div>${farmProfile.contact}</div>
                    
                    ${farmProfile.type ? `
                        <div><strong>Farm Type:</strong></div>
                        <div>${farmProfile.type}</div>
                    ` : ''}
                </div>
            </div>
        `;
        modal.style.display = 'flex';
        
        // Clear any previous code
        const activationCodeInput = getElement('activationCode');
        if (activationCodeInput) {
            activationCodeInput.value = '';
            activationCodeInput.focus();
        }
    }
}
function showActivationSuccess() {
    showNotification(`
        üéâ Welcome to FarmPro Premium! 
        You now have access to:
        ‚úÖ Advanced Analytics
        ‚úÖ Premium Crop Database  
        ‚úÖ Market Price Alerts
        ‚úÖ Weather Integration
        ‚úÖ Priority Support
        ‚úÖ And much more!
    `, 'success');
    
    // Show bonus features modal
    setTimeout(() => {
        showBonusFeaturesModal();
    }, 2000);
}
function activateApp() {
    const activationCode = getElement('activationCode')?.value.trim().toUpperCase();
    
    if (!activationCode) {
        showNotification('Please enter activation code', 'error');
        return;
    }
    
    // Generate expected code based on user's farm details
    const expectedCode = generateActivationCode(farmProfile.farmName, farmProfile.hectares);
    
    // Validate the entered code
    if (activationCode === expectedCode) {
        farmProfile.activated = true;
        farmProfile.activationDate = new Date().toISOString();
        
        if (safeSaveData()) {
            showNotification('‚úÖ FarmPro Premium Activated Successfully!', 'success');
            closeActivationModal();
            updateFarmProfileHeader();
            checkTrialStatus();
            
            // Remove read-only mode
            document.body.classList.remove('readonly-mode');
            
            // Show premium features
            setTimeout(() => {
                showPremiumWelcomeModal();
            }, 1000);
            
        } else {
            showNotification('Failed to save activation', 'error');
        }
    } else {
        showNotification(`Invalid activation code.`, 'error');
    }
}

function showPremiumWelcomeModal() {
    const modalHTML = `
        <div class="activation-modal" style="display: flex;">
            <div class="activation-content" style="max-height: 85vh; overflow-y: auto; text-align: center;">
                <div style="font-size: 4rem; margin-bottom: 1rem;">üéâ</div>
                <h2 style="color: var(--primary); margin-bottom: 0.5rem;">Welcome to FarmPro Premium!</h2>
                <p style="margin-bottom: 2rem;">Your farm management just got superpowers!</p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 1.5rem; border-radius: 10px;">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üìà</div>
                        <h4>Advanced Analytics</h4>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 1.5rem; border-radius: 10px;">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üåç</div>
                        <h4>Market Intelligence</h4>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 1.5rem; border-radius: 10px;">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üå±</div>
                        <h4>Premium Crops</h4>
                    </div>
                </div>

                <div style="background: #e8f5e8; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem;">
                    <h4 style="color: var(--primary); margin-bottom: 1rem;">üöÄ Get Started</h4>
                    <p>Click the <strong>‚≠ê Premium tab</strong> to access all your new features:</p>
                    <ul style="text-align: left; margin: 1rem 0;">
                        <li>Advanced analytics and profitability scores</li>
                        <li>Market intelligence and price trends</li>
                        <li>High-value crop guides (avocado, coffee, macadamia)</li>
                        <li>Financial calculators and tools</li>
                        <li>Automated reporting</li>
                    </ul>
                </div>

                <button onclick="closeAllModals(); openTab('premiumTab')" class="btn-harvest" style="padding: 1rem 2rem; font-size: 1.1rem;">
                    üöÄ Explore Premium Features
                </button>
                
                <p style="margin-top: 1rem; color: var(--muted);">
                    Need help? Contact Support: +267 7678 1005
                </p>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modalHTML);
}

function closeAllModals() {
    document.querySelectorAll('.activation-modal').forEach(modal => {
        modal.style.display = 'none';
    });
}

function showBonusFeaturesModal() {
    const modalHTML = `
        <div class="activation-modal" style="display: flex;">
            <div class="activation-content" style="max-height: 85vh; overflow-y: auto;">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <div style="font-size: 4rem; margin-bottom: 1rem;">üéÅ</div>
                    <h2 style="color: var(--primary); margin-bottom: 0.5rem;">Welcome to FarmPro Premium!</h2>
                    <p>Your farm management just got superpowers! Here's your welcome bonus:</p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 1.5rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üìä</div>
                        <h3>Advanced Analytics</h3>
                        <p>Predict yields, optimize costs, and maximize profits with AI-powered insights</p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 1.5rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">üåç</div>
                        <h3>Market Intelligence</h3>
                        <p>Real-time price alerts and export opportunity notifications</p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 1.5rem; border-radius: 10px; text-align: center;">
                        <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">‚è∞</div>
                        <h3>Smart Alerts</h3>
                        <p>Weather warnings, price drops, and task reminders via SMS</p>
                    </div>
                </div>

                <div style="background: #e8f5e8; padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem;">
                    <h3 style="color: var(--primary); margin-bottom: 1rem;">üöÄ Quick Start Guide</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div>
                            <strong>1. Explore Premium Crops</strong>
                            <p>Check out avocado, coffee, and other high-value crops</p>
                        </div>
                        <div>
                            <strong>2. Set Up Alerts</strong>
                            <p>Configure SMS notifications for prices and weather</p>
                        </div>
                        <div>
                            <strong>3. Try Analytics</strong>
                            <p>Run profitability analysis on your crops</p>
                        </div>
                        <div>
                            <strong>4. Contact Support</strong>
                            <p>Get personalized help with your farm setup</p>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 2rem;">
                    <button onclick="closeAllModals()" class="btn-harvest" style="padding: 1rem 2rem; font-size: 1.1rem;">
                        üöÄ Start Using Premium Features
                    </button>
                    <p style="margin-top: 1rem; color: var(--muted);">
                        Need help? WhatsApp Support: +267 7678 1005
                    </p>
                </div>
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', modalHTML);
}

function closeAllModals() {
    document.querySelectorAll('.activation-modal').forEach(modal => {
        modal.style.display = 'none';
    });
}
function closeActivationModal() {
    const modal = getElement('activationModal');
    if (modal) {
        modal.style.display = 'none';
    }
}

function activateApp() {
    const activationCode = getElement('activationCode')?.value.trim().toUpperCase();
    
    if (!activationCode) {
        showNotification('Please enter activation code', 'error');
        return;
    }
    
    // Generate expected code based on user's farm details
    const expectedCode = generateActivationCode(farmProfile.farmName, farmProfile.hectares);
    
    // Validate the entered code
    if (activationCode === expectedCode) {
        farmProfile.activated = true;
        farmProfile.activationDate = new Date().toISOString();
        
        if (safeSaveData()) {
            showNotification('‚úÖ FarmPro Activated Successfully!', 'success');
            closeActivationModal();
            updateFarmProfileHeader();
            checkTrialStatus();
            
            // Remove read-only mode
            document.body.classList.remove('readonly-mode');
        } else {
            showNotification('Failed to save activation', 'error');
        }
    } else {
        showNotification(`Invalid activation code. Please contact Support with your farm details`, 'error');
        // For debugging - remove in production
        console.log('Expected code:', expectedCode, 'Entered:', activationCode);
    }
}

// =============================================
// SUPPORT TOOL (For you to generate codes)
// =============================================

// Add this function for your support team to generate codes
function generateCodeForSupport() {
    const farmName = prompt("Enter Farm Name:");
    const hectares = parseInt(prompt("Enter Hectares:"));
    
    if (farmName && hectares) {
        const code = generateActivationCode(farmName, hectares);
        alert(`Activation Code for ${farmName} (${hectares}ha): ${code}`);
    }
}

// You can call generateCodeForSupport() in browser console to generate codes
// =============================================
// SHARING FUNCTIONALITY
// =============================================

function shareOnWhatsApp() {
    if (!farmProfile) {
        showNotification('Please set up your farm profile first');
        return;
    }
    
    const message = `Check out my farm "${farmProfile.farmName}" on FarmPro Assistant! ${farmProfile.hectares} hectares of ${farmProfile.type || 'farming'}.`;
    const encodedMessage = encodeURIComponent(message);
    const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
    
    window.open(whatsappUrl, '_blank');
}

// =============================================
// INITIALIZE REPORTS WHEN TAB IS OPENED
// =============================================

// Call generateReports when reports tab is opened
const originalLoadTabData = loadTabData;
loadTabData = function(tabId) {
    originalLoadTabData(tabId);
    
    if (tabId === 'reportsTab') {
        setTimeout(() => {
            generateReports();
        }, 100);
    }
};

// Initialize the app
setTimeout(() => {
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeMainApp);
    } else {
        initializeMainApp();
    }
}, 100);
</script>
</body>
</html>
